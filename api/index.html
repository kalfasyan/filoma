
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Fast, multi-backend file and directory analysis for Python">
      
      
      
      
        <link rel="prev" href="../benchmarks/">
      
      
        <link rel="next" href="../life-after-filoma/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>API Reference - filoma</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="filoma" class="md-header__button md-logo" aria-label="filoma" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            filoma
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="filoma" class="md-nav__button md-logo" aria-label="filoma" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    filoma
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scanning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Directory Scanning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DataFrame Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File & Image Profiling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ML Splits
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Demo
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cookbook
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Quality
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backends
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#filoma" class="md-nav__link">
    <span class="md-ellipsis">
      filoma
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe" class="md-nav__link">
    <span class="md-ellipsis">
      probe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe_file" class="md-nav__link">
    <span class="md-ellipsis">
      probe_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe_image" class="md-nav__link">
    <span class="md-ellipsis">
      probe_image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      probe_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#package-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Package overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataframe-wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      DataFrame wrapper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame" class="md-nav__link">
    <span class="md-ellipsis">
      DataFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.columns" class="md-nav__link">
    <span class="md-ellipsis">
      columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.df" class="md-nav__link">
    <span class="md-ellipsis">
      df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      dtypes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.native" class="md-nav__link">
    <span class="md-ellipsis">
      native
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.pandas" class="md-nav__link">
    <span class="md-ellipsis">
      pandas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pandas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.pandas--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.pandas_cached" class="md-nav__link">
    <span class="md-ellipsis">
      pandas_cached
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.polars" class="md-nav__link">
    <span class="md-ellipsis">
      polars
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.shape" class="md-nav__link">
    <span class="md-ellipsis">
      shape
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__dir__" class="md-nav__link">
    <span class="md-ellipsis">
      __dir__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_depth_col" class="md-nav__link">
    <span class="md-ellipsis">
      add_depth_col
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_file_stats_cols" class="md-nav__link">
    <span class="md-ellipsis">
      add_file_stats_cols
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_filename_features" class="md-nav__link">
    <span class="md-ellipsis">
      add_filename_features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_path_components" class="md-nav__link">
    <span class="md-ellipsis">
      add_path_components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="add_path_components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_path_components--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.describe" class="md-nav__link">
    <span class="md-ellipsis">
      describe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.enrich" class="md-nav__link">
    <span class="md-ellipsis">
      enrich
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.evaluate_duplicates" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_duplicates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.filter_by_extension" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_extension
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.filter_by_pattern" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_pattern
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.from_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      from_pandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_directory" class="md-nav__link">
    <span class="md-ellipsis">
      group_by_directory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="group_by_directory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_directory--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_extension" class="md-nav__link">
    <span class="md-ellipsis">
      group_by_extension
    </span>
  </a>
  
    <nav class="md-nav" aria-label="group_by_extension">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_extension--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.head" class="md-nav__link">
    <span class="md-ellipsis">
      head
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.info" class="md-nav__link">
    <span class="md-ellipsis">
      info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.invalidate_pandas_cache" class="md-nav__link">
    <span class="md-ellipsis">
      invalidate_pandas_cache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.save_csv" class="md-nav__link">
    <span class="md-ellipsis">
      save_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.save_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      save_parquet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.tail" class="md-nav__link">
    <span class="md-ellipsis">
      tail
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.to_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      to_pandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.to_polars" class="md-nav__link">
    <span class="md-ellipsis">
      to_polars
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.unique" class="md-nav__link">
    <span class="md-ellipsis">
      unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      ML helpers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.ml" class="md-nav__link">
    <span class="md-ellipsis">
      ml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.ml.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.ml.split_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.ml.split_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directory-profiler" class="md-nav__link">
    <span class="md-ellipsis">
      Directory profiler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler" class="md-nav__link">
    <span class="md-ellipsis">
      directory_profiler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis" class="md-nav__link">
    <span class="md-ellipsis">
      DirectoryAnalysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DirectoryAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      as_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.print_report" class="md-nav__link">
    <span class="md-ellipsis">
      print_report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.print_summary" class="md-nav__link">
    <span class="md-ellipsis">
      print_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.to_df" class="md-nav__link">
    <span class="md-ellipsis">
      to_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler" class="md-nav__link">
    <span class="md-ellipsis">
      DirectoryProfiler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DirectoryProfiler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_implementation_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_implementation_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled" class="md-nav__link">
    <span class="md-ellipsis">
      is_dataframe_enabled
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_dataframe_enabled">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available" class="md-nav__link">
    <span class="md-ellipsis">
      is_fd_available
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_fd_available">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available" class="md-nav__link">
    <span class="md-ellipsis">
      is_parallel_available
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_parallel_available">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available" class="md-nav__link">
    <span class="md-ellipsis">
      is_rust_available
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_rust_available">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_empty_folders" class="md-nav__link">
    <span class="md-ellipsis">
      print_empty_folders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_file_extensions" class="md-nav__link">
    <span class="md-ellipsis">
      print_file_extensions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_folder_patterns" class="md-nav__link">
    <span class="md-ellipsis">
      print_folder_patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_report" class="md-nav__link">
    <span class="md-ellipsis">
      print_report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_summary" class="md-nav__link">
    <span class="md-ellipsis">
      print_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.probe" class="md-nav__link">
    <span class="md-ellipsis">
      probe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.sample_paths" class="md-nav__link">
    <span class="md-ellipsis">
      sample_paths
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfilerConfig" class="md-nav__link">
    <span class="md-ellipsis">
      DirectoryProfilerConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DirectoryProfilerConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfilerConfig.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../life-after-filoma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Life after filoma
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#filoma" class="md-nav__link">
    <span class="md-ellipsis">
      filoma
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe" class="md-nav__link">
    <span class="md-ellipsis">
      probe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe_file" class="md-nav__link">
    <span class="md-ellipsis">
      probe_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe_image" class="md-nav__link">
    <span class="md-ellipsis">
      probe_image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.probe_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      probe_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#package-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Package overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataframe-wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      DataFrame wrapper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame" class="md-nav__link">
    <span class="md-ellipsis">
      DataFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.columns" class="md-nav__link">
    <span class="md-ellipsis">
      columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.df" class="md-nav__link">
    <span class="md-ellipsis">
      df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      dtypes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.native" class="md-nav__link">
    <span class="md-ellipsis">
      native
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.pandas" class="md-nav__link">
    <span class="md-ellipsis">
      pandas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pandas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.pandas--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.pandas_cached" class="md-nav__link">
    <span class="md-ellipsis">
      pandas_cached
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.polars" class="md-nav__link">
    <span class="md-ellipsis">
      polars
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.shape" class="md-nav__link">
    <span class="md-ellipsis">
      shape
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__dir__" class="md-nav__link">
    <span class="md-ellipsis">
      __dir__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_depth_col" class="md-nav__link">
    <span class="md-ellipsis">
      add_depth_col
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_file_stats_cols" class="md-nav__link">
    <span class="md-ellipsis">
      add_file_stats_cols
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_filename_features" class="md-nav__link">
    <span class="md-ellipsis">
      add_filename_features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_path_components" class="md-nav__link">
    <span class="md-ellipsis">
      add_path_components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="add_path_components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.add_path_components--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.describe" class="md-nav__link">
    <span class="md-ellipsis">
      describe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.enrich" class="md-nav__link">
    <span class="md-ellipsis">
      enrich
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.evaluate_duplicates" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_duplicates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.filter_by_extension" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_extension
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.filter_by_pattern" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_pattern
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.from_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      from_pandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_directory" class="md-nav__link">
    <span class="md-ellipsis">
      group_by_directory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="group_by_directory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_directory--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_extension" class="md-nav__link">
    <span class="md-ellipsis">
      group_by_extension
    </span>
  </a>
  
    <nav class="md-nav" aria-label="group_by_extension">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.group_by_extension--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.head" class="md-nav__link">
    <span class="md-ellipsis">
      head
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.info" class="md-nav__link">
    <span class="md-ellipsis">
      info
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.invalidate_pandas_cache" class="md-nav__link">
    <span class="md-ellipsis">
      invalidate_pandas_cache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.save_csv" class="md-nav__link">
    <span class="md-ellipsis">
      save_csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.save_parquet" class="md-nav__link">
    <span class="md-ellipsis">
      save_parquet
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.tail" class="md-nav__link">
    <span class="md-ellipsis">
      tail
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.to_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      to_pandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.to_polars" class="md-nav__link">
    <span class="md-ellipsis">
      to_polars
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.dataframe.DataFrame.unique" class="md-nav__link">
    <span class="md-ellipsis">
      unique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml-helpers" class="md-nav__link">
    <span class="md-ellipsis">
      ML helpers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.ml" class="md-nav__link">
    <span class="md-ellipsis">
      ml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.ml.split_data" class="md-nav__link">
    <span class="md-ellipsis">
      split_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.ml.split_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.ml.split_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directory-profiler" class="md-nav__link">
    <span class="md-ellipsis">
      Directory profiler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler" class="md-nav__link">
    <span class="md-ellipsis">
      directory_profiler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis" class="md-nav__link">
    <span class="md-ellipsis">
      DirectoryAnalysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DirectoryAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      as_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      from_dict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_dict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.print_report" class="md-nav__link">
    <span class="md-ellipsis">
      print_report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.print_summary" class="md-nav__link">
    <span class="md-ellipsis">
      print_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.to_df" class="md-nav__link">
    <span class="md-ellipsis">
      to_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryAnalysis.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler" class="md-nav__link">
    <span class="md-ellipsis">
      DirectoryProfiler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DirectoryProfiler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_implementation_info
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_implementation_info">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled" class="md-nav__link">
    <span class="md-ellipsis">
      is_dataframe_enabled
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_dataframe_enabled">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available" class="md-nav__link">
    <span class="md-ellipsis">
      is_fd_available
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_fd_available">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available" class="md-nav__link">
    <span class="md-ellipsis">
      is_parallel_available
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_parallel_available">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available" class="md-nav__link">
    <span class="md-ellipsis">
      is_rust_available
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_rust_available">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_empty_folders" class="md-nav__link">
    <span class="md-ellipsis">
      print_empty_folders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_file_extensions" class="md-nav__link">
    <span class="md-ellipsis">
      print_file_extensions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_folder_patterns" class="md-nav__link">
    <span class="md-ellipsis">
      print_folder_patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_report" class="md-nav__link">
    <span class="md-ellipsis">
      print_report
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_summary" class="md-nav__link">
    <span class="md-ellipsis">
      print_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.probe" class="md-nav__link">
    <span class="md-ellipsis">
      probe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfiler.sample_paths" class="md-nav__link">
    <span class="md-ellipsis">
      sample_paths
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfilerConfig" class="md-nav__link">
    <span class="md-ellipsis">
      DirectoryProfilerConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DirectoryProfilerConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filoma.directories.directory_profiler.DirectoryProfilerConfig.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p>This page uses <code>mkdocstrings</code> to generate an API reference from the <code>src/filoma</code> package.</p>


<div class="doc doc-object doc-module">



<a id="filoma"></a>
    <div class="doc doc-contents first">

        <p>filoma: filesystem profiling and directory analysis.</p>
<p>A modular Python tool for profiling files, analyzing directory structures,
and inspecting image data.</p>
<p>This module exposes a tiny, ergonomic public surface while importing
heavy optional dependencies lazily (Polars, Pillow, Rust extension,
etc.). Accessing convenience classes like :class:<code>DataFrame</code> or
subpackages like <code>filoma.directories</code> will import the underlying
modules on-demand.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="filoma.__getattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#filoma.__getattr__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Lazy import and attribute resolution for top-level names.</p>
<p>Implements PEP 562: import submodules or attributes on demand.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lazy import and attribute resolution for top-level names.</span>

<span class="sd">    Implements PEP 562: import submodules or attributes on demand.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># top-level subpackages</span>
        <span class="s2">&quot;core&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.core&quot;</span><span class="p">,</span>
        <span class="s2">&quot;directories&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.directories&quot;</span><span class="p">,</span>
        <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;images&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.images&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ml&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.ml&quot;</span><span class="p">,</span>
        <span class="c1"># common classes placed in submodules (module:attr)</span>
        <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.dataframe:DataFrame&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DirectoryProfiler&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.directories.directory_profiler:DirectoryProfiler&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FileProfiler&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.files.file_profiler:FileProfiler&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ImageProfiler&quot;</span><span class="p">:</span> <span class="s2">&quot;filoma.images.image_profiler:ImageProfiler&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">target</span><span class="p">:</span>
            <span class="n">module_name</span><span class="p">,</span> <span class="n">attr</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="nb">globals</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module </span><span class="si">{</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s2"> has no attribute </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.probe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">probe</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#filoma.probe" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Quick helper: probe a directory path and return a DirectoryAnalysis.</p>
<p>This wrapper accepts probe-specific keyword arguments such as
<code>max_depth</code> and <code>threads</code> and forwards them to
:class:<code>DirectoryProfiler.probe</code>. Other kwargs are used to configure the
:class:<code>DirectoryProfiler</code> constructor.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">probe</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Quick helper: probe a directory path and return a DirectoryAnalysis.</span>

<span class="sd">    This wrapper accepts probe-specific keyword arguments such as</span>
<span class="sd">    ``max_depth`` and ``threads`` and forwards them to</span>
<span class="sd">    :class:`DirectoryProfiler.probe`. Other kwargs are used to configure the</span>
<span class="sd">    :class:`DirectoryProfiler` constructor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract probe-only parameters so they are not passed to the</span>
    <span class="c1"># DirectoryProfiler constructor (which doesn&#39;t accept them).</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_depth&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">threads</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;threads&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># If the provided path points to a file, dispatch to FileProfiler.probe</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="c1"># Forward any file-specific kwargs (e.g., compute_hash) via kwargs</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.files.file_profiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileProfiler</span>

            <span class="k">return</span> <span class="n">FileProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># If any checks fail, fall back to directory probing behaviour and</span>
        <span class="c1"># let the underlying profiler raise appropriate errors.</span>
        <span class="k">pass</span>

    <span class="c1"># Local import to ensure the class is available without forcing it at</span>
    <span class="c1"># module import time.</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.directories</span><span class="w"> </span><span class="kn">import</span> <span class="n">DirectoryProfiler</span><span class="p">,</span> <span class="n">DirectoryProfilerConfig</span>

    <span class="c1"># Build a typed config from remaining kwargs and instantiate the profiler</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">DirectoryProfilerConfig</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">profiler</span> <span class="o">=</span> <span class="n">DirectoryProfiler</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">profiler</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.probe_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">probe_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#filoma.probe_file" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Quick helper: probe a single file and return a Filo dataclass.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">probe_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Quick helper: probe a single file and return a Filo dataclass.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.files.file_profiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileProfiler</span>

    <span class="k">return</span> <span class="n">FileProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.probe_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">probe_image</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#filoma.probe_image" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Analyze an image.</p>
<p>If <code>arg</code> is a numpy array, :class:<code>ImageProfiler.probe</code> is used; if
it's path-like, attempt to locate an image-specific profiler or load it
to numpy and analyze.</p>
<p>This wrapper favors simplicity for interactive use; for advanced
control instantiate profilers directly.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">probe_image</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze an image.</span>

<span class="sd">    If ``arg`` is a numpy array, :class:`ImageProfiler.probe` is used; if</span>
<span class="sd">    it&#39;s path-like, attempt to locate an image-specific profiler or load it</span>
<span class="sd">    to numpy and analyze.</span>

<span class="sd">    This wrapper favors simplicity for interactive use; for advanced</span>
<span class="sd">    control instantiate profilers directly.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Local imports; keep them inside the function to avoid heavy deps at</span>
    <span class="c1"># module import time.</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">_np</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">_np</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># If it&#39;s a numpy array, use ImageProfiler directly</span>
    <span class="k">if</span> <span class="n">_np</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">_np</span><span class="p">,</span> <span class="s2">&quot;ndarray&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.images.image_profiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageProfiler</span>

        <span class="k">return</span> <span class="n">ImageProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="c1"># Treat as path-like</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="n">suffix</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">suffix</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Use images package specializers when available</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.images</span><span class="w"> </span><span class="kn">import</span> <span class="n">NpyProfiler</span><span class="p">,</span> <span class="n">PngProfiler</span><span class="p">,</span> <span class="n">TifProfiler</span><span class="p">,</span> <span class="n">ZarrProfiler</span>

        <span class="k">if</span> <span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.png&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PngProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.npy&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">NpyProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;.tif&quot;</span><span class="p">,</span> <span class="s2">&quot;.tiff&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TifProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.zarr&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ZarrProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># If specialist creation fails, fall back to generic loader below</span>
        <span class="k">pass</span>

    <span class="c1"># Generic fallback: try Pillow + numpy loader</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Third-party import</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">_PILImage</span>

        <span class="c1"># Local import</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.images.image_profiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageProfiler</span>

        <span class="n">img</span> <span class="o">=</span> <span class="n">_PILImage</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="k">if</span> <span class="n">_np</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">arr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ImageProfiler</span><span class="p">()</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># Last resort: return an ImageReport with status explaining failure</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.images.image_profiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageReport</span>

    <span class="k">return</span> <span class="n">ImageReport</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">status</span><span class="o">=</span><span class="s2">&quot;failed_to_load_or_unsupported_format&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.probe_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">probe_to_df</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">to_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enrich</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#filoma.probe_to_df" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return a Polars DataFrame (or pandas if to_pandas=True).</p>
<p>Force DataFrame building on the profiler and optionally run a small
enrichment chain: .add_depth_col(path).add_path_components().add_file_stats_cols().</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">probe_to_df</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">to_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">enrich</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a Polars DataFrame (or pandas if to_pandas=True).</span>

<span class="sd">    Force DataFrame building on the profiler and optionally run a small</span>
<span class="sd">    enrichment chain: .add_depth_col(path).add_path_components().add_file_stats_cols().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract probe-only parameters</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_depth&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">threads</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;threads&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Lazy import to avoid heavy deps at module import time</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.directories</span><span class="w"> </span><span class="kn">import</span> <span class="n">DirectoryProfiler</span><span class="p">,</span> <span class="n">DirectoryProfilerConfig</span>

    <span class="c1"># Force DataFrame building and construct a typed config</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;build_dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">DirectoryProfilerConfig</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">profiler</span> <span class="o">=</span> <span class="n">DirectoryProfiler</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">analysis</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span>

    <span class="n">df_wrapper</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">df_wrapper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;DataFrame was not built. Ensure &#39;polars&#39; is installed and that DataFrame building is enabled (build_dataframe=True).&quot;</span><span class="p">)</span>

    <span class="c1"># Optionally enrich the DataFrame wrapper with useful columns/stats</span>
    <span class="n">df_enriched</span> <span class="o">=</span> <span class="n">df_wrapper</span>
    <span class="k">if</span> <span class="n">enrich</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df_enriched</span> <span class="o">=</span> <span class="n">df_enriched</span><span class="o">.</span><span class="n">add_depth_col</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">add_path_components</span><span class="p">()</span><span class="o">.</span><span class="n">add_file_stats_cols</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># If enrichment fails for any reason, fall back to the raw DataFrame</span>
            <span class="k">pass</span>

    <span class="c1"># Return requested format: filoma.DataFrame wrapper (default) or pandas</span>
    <span class="c1"># Keep the `to_pandas` convenience for callers that explicitly want pandas</span>
    <span class="k">if</span> <span class="n">to_pandas</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df_enriched</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to convert Polars DataFrame to pandas: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_enriched</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="package-overview">Package overview<a class="headerlink" href="#package-overview" title="Permanent link">&para;</a></h2>
<p>The top-level package docstring is rendered above. Below are some focused sections for important modules and classes.</p>
<h2 id="dataframe-wrapper">DataFrame wrapper<a class="headerlink" href="#dataframe-wrapper" title="Permanent link">&para;</a></h2>
<p>The <code>filoma.DataFrame</code> wrapper provides convenience enrichers and helpers that operate on a Polars DataFrame internally.</p>


<div class="doc doc-object doc-class">



<a id="filoma.dataframe.DataFrame"></a>
    <div class="doc doc-contents first">


        <p>A wrapper around Polars DataFrame for enhanced file and directory analysis.</p>
<p>This class provides a specialized interface for working with file path data,
allowing for easy manipulation and analysis of filesystem information.</p>
<p>All standard Polars DataFrame methods and properties are available through
attribute delegation, so you can use this like a regular Polars DataFrame
with additional file-specific functionality.</p>








              <details class="quote">
                <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A wrapper around Polars DataFrame for enhanced file and directory analysis.</span>

<span class="sd">    This class provides a specialized interface for working with file path data,</span>
<span class="sd">    allowing for easy manipulation and analysis of filesystem information.</span>

<span class="sd">    All standard Polars DataFrame methods and properties are available through</span>
<span class="sd">    attribute delegation, so you can use this like a regular Polars DataFrame</span>
<span class="sd">    with additional file-specific functionality.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            data: Initial data. Can be:</span>
<span class="sd">                - A Polars DataFrame</span>
<span class="sd">                - A dictionary mapping column names to sequences (all same length)</span>
<span class="sd">                - A list of string paths</span>
<span class="sd">                - A list of Path objects</span>
<span class="sd">                - None for an empty DataFrame</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="p">[]},</span> <span class="n">schema</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">})</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">processed</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">expected_len</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dictionary values must be list or tuple sequences&quot;</span><span class="p">)</span>
                    <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">expected_len</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">expected_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_len</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All dictionary value sequences must have the same length&quot;</span><span class="p">)</span>
                    <span class="n">processed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">processed</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">paths</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;data must be a Polars DataFrame, dict of columns, list of paths, or None&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_filename_features</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ensure the internal `_df` is a Polars DataFrame.</span>

<span class="sd">        If the underlying object is not a Polars DataFrame attempt to convert</span>
<span class="sd">        it (via pandas conversion if available or `pl.DataFrame(...)`). This</span>
<span class="sd">        prevents AttributeError when methods expect Polars APIs like</span>
<span class="sd">        `with_columns` or `map_elements`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Fast path</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span>

        <span class="c1"># Try pandas conversion first if pandas is present and this looks like</span>
        <span class="c1"># a pandas DataFrame</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">)</span>
                <span class="c1"># Invalidate any cached pandas view since we&#39;ve converted</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># fall through to generic conversion</span>
            <span class="k">pass</span>

        <span class="c1"># Generic attempt to coerce into a Polars DataFrame</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to coerce internal DataFrame to polars.DataFrame: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegate attribute access to the underlying Polars DataFrame.</span>

<span class="sd">        This allows direct access to all Polars DataFrame methods and properties</span>
<span class="sd">        like columns, dtypes, shape, select, filter, group_by, etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Directly return the attribute from the underlying Polars DataFrame.</span>
        <span class="c1"># NOTE: We intentionally do NOT wrap returned Polars DataFrames anymore.</span>
        <span class="c1"># This makes filoma.DataFrame behave like a Polars DataFrame by default</span>
        <span class="c1"># (calls like df.head(), df.select(...), etc. return native Polars</span>
        <span class="c1"># objects). This is a breaking change compared to previously wrapping</span>
        <span class="c1"># Polars results in filoma.DataFrame.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># Preserve the original error semantics</span>
            <span class="k">raise</span>

        <span class="c1"># If the attribute is callable, return a wrapper that conditionally</span>
        <span class="c1"># wraps returned polars.DataFrame objects into filoma.DataFrame</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">attr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="c1"># If the underlying call mutated the Polars DataFrame in-place,</span>
                <span class="c1"># Polars often returns None or the same object reference. In</span>
                <span class="c1"># that case invalidate the cached pandas conversion so future</span>
                <span class="c1"># .pandas/.pandas_cached calls reflect the mutation.</span>
                <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">result</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="c1"># Best-effort: do not let cache invalidation break calls</span>
                        <span class="k">pass</span>
                    <span class="k">return</span> <span class="n">result</span>

                <span class="c1"># If wrapping is enabled and result is a Polars DataFrame,</span>
                <span class="c1"># wrap it back into filoma.DataFrame for compatibility.</span>
                <span class="k">if</span> <span class="n">get_default_wrap_polars</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">result</span>

            <span class="k">return</span> <span class="n">wrapper</span>

        <span class="c1"># Non-callable attributes (properties)  if it&#39;s a Polars DataFrame and</span>
        <span class="c1"># wrapping is requested, wrap it; otherwise return as-is.</span>
        <span class="k">if</span> <span class="n">get_default_wrap_polars</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">attr</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Expose both wrapper and underlying Polars attributes in interactive help.&quot;&quot;&quot;</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">attrs</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward subscription (e.g., df[&#39;path&#39;]) to the underlying Polars DataFrame.</span>

<span class="sd">        Returns native Polars objects (Series or DataFrame) to match the default</span>
<span class="sd">        Polars-first behavior of this wrapper.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward item assignment to the underlying Polars DataFrame.&quot;&quot;&quot;</span>
        <span class="c1"># Polars DataFrame supports column assignment via df[key] = value</span>
        <span class="c1"># Try to support common user-friendly patterns: assigning a Python</span>
        <span class="c1"># sequence or a Series to create/replace a column. Polars&#39; native</span>
        <span class="c1"># __setitem__ may raise TypeError in some versions, so handle that</span>
        <span class="c1"># explicitly and fall back to with_columns.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># Accept polars Series, pandas Series, or Python sequences</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="n">series</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># pandas Series -&gt; polars Series</span>
                        <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;__array__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                            <span class="n">series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                            <span class="n">series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Scalar value: repeat across rows</span>
                            <span class="n">series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="n">series</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="s2">&quot;series&quot;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">series</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Use with_columns to add/replace the column</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
                    <span class="k">return</span>

            <span class="c1"># Fallback to delegating to Polars __setitem__ for other patterns</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="c1"># Underlying data has changed; invalidate any cached pandas conversion</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="c1"># Polars raises TypeError for some unsupported assignment forms</span>
            <span class="c1"># (e.g., assigning a Series by index). Re-raise a clearer message</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;DataFrame object does not support `Series` assignment by index</span><span class="se">\n\n</span><span class="s2">Use `DataFrame.with_columns`.&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invalidate_pandas_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the cached pandas conversion created by `to_pandas()`.</span>

<span class="sd">        Call this after mutating the underlying Polars DataFrame to ensure</span>
<span class="sd">        subsequent `pandas` accesses reflect the latest data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the underlying Polars DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the number of rows in the DataFrame.&quot;&quot;&quot;</span>
        <span class="c1"># polars.DataFrame supports len(), but some wrapped/native objects</span>
        <span class="c1"># (for example older PyArrow-backed objects) may not implement __len__.</span>
        <span class="c1"># Try common fallbacks in order of preference.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># polars exposes `.height` as row count and `.shape[0]` as rows</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="c1"># Last resort: convert to pandas if available (cheap for small frames)</span>
                    <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                            <span class="k">return</span> <span class="mi">0</span>
                    <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the string representation of the DataFrame.&quot;&quot;&quot;</span>
        <span class="c1"># Avoid calling the underlying object&#39;s __str__/__repr__ if it may</span>
        <span class="c1"># raise TypeError (observed with some PyDataFrame wrappers). Use</span>
        <span class="c1"># safe fallbacks for a short textual preview.</span>
        <span class="n">row_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Try polars&#39; to_string-like rendering if available</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Polars DataFrame implements __str__/__repr__; prefer repr()</span>
            <span class="n">df_preview</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Try to convert to pandas for a safer repr</span>
                <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">df_preview</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df_preview</span> <span class="o">=</span> <span class="s2">&quot;&lt;unrepresentable DataFrame&gt;&quot;</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">df_preview</span> <span class="o">=</span> <span class="s2">&quot;&lt;unrepresentable DataFrame&gt;&quot;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;filoma.DataFrame with </span><span class="si">{</span><span class="n">row_count</span><span class="si">}</span><span class="s2"> rows</span><span class="se">\n</span><span class="si">{</span><span class="n">df_preview</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the string representation of the DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first n rows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last n rows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_path_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add columns for path components (parent, name, stem, suffix).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            New DataFrame with additional path component columns</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df_with_components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">),</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">),</span>
                <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">),</span>
                <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;stem&quot;</span><span class="p">),</span>
                <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;suffix&quot;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_with_components</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_with_components</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_file_stats_cols</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
        <span class="n">base_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add file statistics columns (size, modified time, etc.) based on a column containing filesystem paths.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Name of the column containing file system paths.</span>
<span class="sd">            base_path: Optional base path. If provided, any non-absolute paths in the</span>
<span class="sd">                path column are resolved relative to this base.</span>
<span class="sd">            inplace: If True, modify this DataFrame in-place and return ``self``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New DataFrame with file statistics columns added, or ``self`` when</span>
<span class="sd">            ``inplace=True``.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the specified path column does not exist.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame&quot;</span><span class="p">)</span>

        <span class="c1"># Resolve base path if provided</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">base_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">base_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Use filoma&#39;s FileProfiler to collect rich file metadata</span>
        <span class="n">profiler</span> <span class="o">=</span> <span class="n">FileProfiler</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">get_file_stats</span><span class="p">(</span><span class="n">path_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">base</span> <span class="o">/</span> <span class="n">p</span>
                <span class="n">full_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path does not exist: </span><span class="si">{</span><span class="n">full_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">}</span>

                <span class="c1"># Use the profiler; let it handle symlinks and permissions</span>
                <span class="n">filo</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="n">compute_hash</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">filo</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>

                <span class="c1"># Normalize keys to a stable schema used by this helper</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;modified&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_file&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_dir&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mode_str&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inode&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nlink&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sha256&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;xattrs&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}),</span>
                <span class="p">}</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># On any error, return a row of Nones/empties preserving schema</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">}</span>

        <span class="n">stats_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_file_stats</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">path</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>

        <span class="n">stats_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">stats_data</span><span class="p">,</span>
            <span class="n">schema</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span>
                <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">,</span>
                <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span>
                <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span>
                <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>

        <span class="n">df_with_stats</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="n">stats_df</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_with_stats</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_with_stats</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_depth_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a depth column showing the nesting level of each path.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            path: The path to calculate depth from. If None, uses the common root.</span>
<span class="sd">            inplace: If True, modify this DataFrame in-place and return ``self``.</span>

<span class="sd">        Returns:</span>
<span class="sd">        -------</span>
<span class="sd">            New DataFrame with depth column</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Find the common root path</span>
            <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">paths</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Find common parent</span>
                <span class="n">common_parts</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">first_parts</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parts</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">part</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">first_parts</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">part</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">):</span>
                        <span class="n">common_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="o">*</span><span class="n">common_parts</span><span class="p">)</span> <span class="k">if</span> <span class="n">common_parts</span> <span class="k">else</span> <span class="n">Path</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Use a different local name to avoid shadowing the parameter inside calculate_depth</span>
        <span class="n">path_root</span> <span class="o">=</span> <span class="n">path</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">calculate_depth</span><span class="p">(</span><span class="n">path_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Calculate the depth of a path relative to the provided root path.&quot;&quot;&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
                <span class="n">relative_path</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">path_root</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">relative_path</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c1"># Path is not relative to the provided root path</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>

        <span class="n">df_with_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">calculate_depth</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_with_depth</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_with_depth</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_by_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extensions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the DataFrame to only include files with specific extensions.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            extensions: File extension(s) to filter by (with or without leading dot)</span>

<span class="sd">        Returns:</span>
<span class="sd">        -------</span>
<span class="sd">            Filtered DataFrame</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extensions</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">extensions</span><span class="p">]</span>

        <span class="c1"># Normalize extensions (ensure they start with a dot)</span>
        <span class="n">normalized_extensions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
                <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">ext</span>
            <span class="n">normalized_extensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

        <span class="n">filtered_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">normalized_extensions</span><span class="p">,</span>
                <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_by_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the DataFrame by path pattern.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            pattern: Pattern to match (uses Polars string contains)</span>

<span class="sd">        Returns:</span>
<span class="sd">        -------</span>
<span class="sd">            Filtered DataFrame</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filtered_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pattern</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">group_by_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Group files by extension and count them.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Polars DataFrame with extension counts</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># underlying `_df` is expected to be a Polars DataFrame</span>
        <span class="n">df_with_ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">map_elements</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="k">else</span> <span class="s2">&quot;&lt;no extension&gt;&quot;</span><span class="p">),</span>
                    <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;extension&quot;</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">df_with_ext</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;extension&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;len&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">group_by_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Group files by their parent directory and count them.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Polars DataFrame with directory counts</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># underlying `_df` is expected to be a Polars DataFrame</span>
        <span class="n">df_with_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
            <span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">),</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;parent_dir&quot;</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">df_with_parent</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;parent_dir&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;len&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the underlying Polars DataFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to a pandas DataFrame.</span>

<span class="sd">        By default this method will return a cached pandas conversion if one</span>
<span class="sd">        exists (for performance). Set ``force=True`` to reconvert from the</span>
<span class="sd">        current Polars DataFrame and update the cache.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;pandas is not installed. Please install it to use to_pandas().&quot;</span><span class="p">)</span>
        <span class="c1"># Convert and cache on first access or when forced</span>
        <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Use Polars&#39; to_pandas conversion for consistency</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Property access for the underlying Polars DataFrame (convenience).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_polars</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a fresh pandas DataFrame conversion (not the cached object).</span>

<span class="sd">        This is intentionally a fresh conversion so callers who expect an</span>
<span class="sd">        up-to-date pandas view can access it directly. Use ``pandas_cached`` or</span>
<span class="sd">        ``to_pandas(force=False)`` to access the cached conversion for repeated</span>
<span class="sd">        reads, or ``to_pandas(force=True)`` to reconvert and update the cache.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">            ImportError: if pandas is not installed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;pandas is not installed. Please install it to use pandas property.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pandas_cached</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a cached pandas DataFrame, converting once if needed.</span>

<span class="sd">        This is useful when repeated conversions would be expensive and the</span>
<span class="sd">        caller is comfortable with an explicit cache that can be invalidated</span>
<span class="sd">        with ``invalidate_pandas_cache()`` or by calling ``to_pandas(force=True)``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">native</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the dataframe in the module-wide default backend.</span>

<span class="sd">        If `get_default_dataframe_backend()` is &#39;polars&#39; this returns a Polars</span>
<span class="sd">        DataFrame, otherwise it returns a pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">get_default_dataframe_backend</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;polars&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">polars</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pandas</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pandas</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a filoma.DataFrame from a pandas DataFrame.</span>

<span class="sd">        This is a convenience wrapper that converts the pandas DataFrame into</span>
<span class="sd">        a Polars DataFrame and wraps it. Requires pandas to be installed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;pandas is not available in this environment&quot;</span><span class="p">)</span>
        <span class="c1"># Convert via Polars for internal consistency</span>
        <span class="n">pl_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">pl_df</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to a dictionary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">as_series</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the DataFrame to CSV.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_parquet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the DataFrame to Parquet format.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">write_parquet</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="c1"># Convenience methods for common Polars operations that users expect</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get column names.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">columns</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dtypes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get column data types.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">dtypes</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get DataFrame shape (rows, columns).&quot;&quot;&quot;</span>
        <span class="c1"># Attempt to return a (rows, cols) tuple even if the underlying</span>
        <span class="c1"># object doesn&#39;t expose .shape or len(). Use the same fallbacks as</span>
        <span class="c1"># in __len__ for rows and inspect columns for width.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># Rows fallback</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># Columns fallback: try .columns or pandas conversion</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="s2">&quot;columns&quot;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">cols</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="n">cols</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">cols</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate descriptive statistics.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            percentiles: List of percentiles to include (default: [0.25, 0.5, 0.75])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Polars&#39; describe returns a new DataFrame summarizing columns; wrap it</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="n">percentiles</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print concise summary of the DataFrame.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;filoma.DataFrame&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>

        <span class="c1"># Column info</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column details:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)):</span>
            <span class="n">null_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">null_count</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">col</span><span class="si">:</span><span class="s2">15s</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">:</span><span class="s2">15s</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">null_count</span><span class="si">:</span><span class="s2">8d</span><span class="si">}</span><span class="s2"> nulls&quot;</span><span class="p">)</span>

        <span class="c1"># Memory usage approximation</span>
        <span class="n">memory_mb</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">estimated_size</span><span class="p">(</span><span class="s2">&quot;mb&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Estimated memory usage: </span><span class="si">{</span><span class="n">memory_mb</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">unique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get unique rows.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            subset: Column name(s) to consider for uniqueness</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            by: Column name(s) to sort by</span>
<span class="sd">            descending: Sort in descending order</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="c1"># -------------------- ML convenience API -------------------- #</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">split_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">train_val_test</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="n">feature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;path_parts&quot;</span><span class="p">,</span>
        <span class="n">path_parts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span>
        <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
        <span class="n">feat_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span>
        <span class="n">max_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">include_all_parts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">token_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">path_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;filoma&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deterministically split this filoma DataFrame into train/val/test.</span>

<span class="sd">        This is a thin wrapper around ``filoma.ml.split_data`` so you can call</span>
<span class="sd">        ``df.split_data(...)`` directly on a filoma DataFrame instance.</span>

<span class="sd">        Args mirror :func:`filoma.ml.split_data` except ``df`` is implicit.</span>

<span class="sd">        By default ``return_type=&#39;filoma&#39;`` so the three returned objects are</span>
<span class="sd">        filoma.DataFrame wrappers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Local import to avoid loading ml utilities unless used</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">ml</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">ml</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">train_val_test</span><span class="o">=</span><span class="n">train_val_test</span><span class="p">,</span>
            <span class="n">feature</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span>
            <span class="n">path_parts</span><span class="o">=</span><span class="n">path_parts</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">discover</span><span class="o">=</span><span class="n">discover</span><span class="p">,</span>
            <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
            <span class="n">feat_prefix</span><span class="o">=</span><span class="n">feat_prefix</span><span class="p">,</span>
            <span class="n">max_tokens</span><span class="o">=</span><span class="n">max_tokens</span><span class="p">,</span>
            <span class="n">include_parent</span><span class="o">=</span><span class="n">include_parent</span><span class="p">,</span>
            <span class="n">include_all_parts</span><span class="o">=</span><span class="n">include_all_parts</span><span class="p">,</span>
            <span class="n">token_names</span><span class="o">=</span><span class="n">token_names</span><span class="p">,</span>
            <span class="n">path_col</span><span class="o">=</span><span class="n">path_col</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">return_type</span><span class="o">=</span><span class="n">return_type</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">enrich</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enrich the DataFrame by adding features like path components, file stats, and depth.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            inplace: If True, perform the operation in-place and return self.</span>
<span class="sd">                     If False (default), return a new DataFrame with the changes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Chain the enrichment methods; this produces a new DataFrame wrapper</span>
        <span class="n">enriched_wrapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_path_components</span><span class="p">()</span><span class="o">.</span><span class="n">add_file_stats_cols</span><span class="p">()</span><span class="o">.</span><span class="n">add_depth_col</span><span class="p">()</span>
        <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="c1"># Update the internal state of the current object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">_df</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># Return the new, enriched DataFrame instance</span>
        <span class="k">return</span> <span class="n">enriched_wrapper</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_duplicates</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
        <span class="n">text_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">image_max_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">text_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">show_table</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate duplicates among files in the DataFrame.</span>

<span class="sd">        Scans the `path_col` column, runs exact, text and image duplicate</span>
<span class="sd">        detectors and prints a small Rich table summarizing counts.</span>

<span class="sd">        Returns the raw dict produced by `filoma.dedup.find_duplicates`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">path_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">path_col</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame&quot;</span><span class="p">)</span>

        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">path_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">_dedup</span><span class="o">.</span><span class="n">find_duplicates</span><span class="p">(</span>
            <span class="n">paths</span><span class="p">,</span>
            <span class="n">text_k</span><span class="o">=</span><span class="n">text_k</span><span class="p">,</span>
            <span class="n">text_threshold</span><span class="o">=</span><span class="n">text_threshold</span><span class="p">,</span>
            <span class="n">image_max_distance</span><span class="o">=</span><span class="n">image_max_distance</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Summarize counts</span>
        <span class="n">exact_groups</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">text_groups</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">image_groups</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">show_table</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Duplicate Summary&quot;</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold cyan&quot;</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Groups&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Files In Groups&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="s2">&quot;exact&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_groups</span><span class="p">)),</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">exact_groups</span><span class="p">)</span> <span class="k">if</span> <span class="n">exact_groups</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="s2">&quot;text&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text_groups</span><span class="p">)),</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">text_groups</span><span class="p">)</span> <span class="k">if</span> <span class="n">text_groups</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="s2">&quot;image&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">image_groups</span><span class="p">)),</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">image_groups</span><span class="p">)</span> <span class="k">if</span> <span class="n">image_groups</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Duplicate summary: exact=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_groups</span><span class="p">)</span><span class="si">}</span><span class="s2"> groups &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">exact_groups</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">exact_groups</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2"> files), &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;text=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">text_groups</span><span class="p">)</span><span class="si">}</span><span class="s2"> groups &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">text_groups</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">text_groups</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2"> files), &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;image=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_groups</span><span class="p">)</span><span class="si">}</span><span class="s2"> groups &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">image_groups</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">image_groups</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2"> files)&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_filename_features</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
        <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span>
        <span class="n">max_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">include_all_parts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">token_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enrich</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Discover filename features and add them as columns on this DataFrame.</span>

<span class="sd">        This instance method discovers separator-based tokens from filename</span>
<span class="sd">        stems and adds columns (e.g., `feat1`, `feat2` or `token1`, ...).</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            path_col: Column containing path strings to analyze (default: &#39;path&#39;).</span>
<span class="sd">            sep: Separator used to split filename stems (default: &#39;_&#39;).</span>
<span class="sd">            prefix: Column name prefix for discovered tokens (default: &#39;feat&#39;).</span>
<span class="sd">            max_tokens: Optional cap on extracted tokens; by default uses observed max.</span>
<span class="sd">            include_parent: If True, add a `parent` column containing immediate parent folder name.</span>
<span class="sd">            include_all_parts: If True, add `path_part0`, `path_part1`, ... for all Path.parts.</span>
<span class="sd">            token_names: Optional list of token column names or &#39;auto&#39; to generate readable names.</span>
<span class="sd">            enrich: If True, automatically enrich the DataFrame with path components and file stats before discovery.</span>
<span class="sd">            inplace: If True, perform the operation in-place and return self. Otherwise returns a new `filoma.DataFrame`.</span>

<span class="sd">        Returns:</span>
<span class="sd">        -------</span>
<span class="sd">            A new or modified `filoma.DataFrame` with discovered filename features.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Determine the base Polars DataFrame for feature discovery</span>
        <span class="n">base_df</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="n">enrich</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Enriching DataFrame before discovering filename features&quot;</span><span class="p">)</span>
            <span class="n">base_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enrich</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Polars-native implementation inlined here (formerly a top-level helper).</span>
        <span class="n">pl_df</span> <span class="o">=</span> <span class="n">base_df</span><span class="o">.</span><span class="n">_df</span>
        <span class="k">if</span> <span class="n">path_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pl_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame must have a &#39;</span><span class="si">{</span><span class="n">path_col</span><span class="si">}</span><span class="s2">&#39; column&quot;</span><span class="p">)</span>

        <span class="n">stems</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">pl_df</span><span class="p">[</span><span class="n">path_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
        <span class="n">split_tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">if</span> <span class="n">stem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">stem</span> <span class="ow">in</span> <span class="n">stems</span><span class="p">]</span>
        <span class="n">observed_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">split_tokens</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_tokens</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">eff_max</span> <span class="o">=</span> <span class="n">observed_max</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">eff_max</span> <span class="o">=</span> <span class="n">max_tokens</span>

        <span class="c1"># Normalize token_names</span>
        <span class="k">if</span> <span class="n">token_names</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="n">token_names_seq</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">auto_mode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token_names</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">token_names_seq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">token_names</span><span class="p">)</span>
            <span class="n">auto_mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">token_names_seq</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">auto_mode</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">new_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eff_max</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">token_names_seq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">token_names_seq</span><span class="p">)</span> <span class="ow">and</span> <span class="n">token_names_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="n">token_names_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">auto_mode</span><span class="p">:</span>
                <span class="n">base</span> <span class="o">=</span> <span class="n">prefix</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="s2">&quot;token&quot;</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base</span><span class="si">}{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;token</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">pick_token</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
                <span class="n">st</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">if</span> <span class="n">st</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;&quot;</span>

            <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">path_col</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">pick_token</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">col_name</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">include_parent</span><span class="p">:</span>
            <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">path_col</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">include_all_parts</span><span class="p">:</span>
            <span class="n">parts_lists</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">pl_df</span><span class="p">[</span><span class="n">path_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
            <span class="n">max_parts</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts_lists</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_parts</span><span class="p">):</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;path_part</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="k">def</span><span class="w"> </span><span class="nf">pick_part</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">parts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

                <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">path_col</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">pick_part</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">col_name</span><span class="p">))</span>

        <span class="n">pl_result</span> <span class="o">=</span> <span class="n">pl_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">new_cols</span><span class="p">)</span>

        <span class="c1"># Wrap the result in a filoma.DataFrame</span>
        <span class="n">enriched_wrapper</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">pl_result</span><span class="p">)</span>
        <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">with_filename_features</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">_df</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">with_filename_features</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">enrich</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">enriched_wrapper</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">columns</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.columns" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get column names.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">df</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.df" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the underlying Polars DataFrame.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.dtypes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dtypes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.dtypes" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get column data types.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.native" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">native</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.native" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the dataframe in the module-wide default backend.</p>
<p>If <code>get_default_dataframe_backend()</code> is 'polars' this returns a Polars
DataFrame, otherwise it returns a pandas DataFrame.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.pandas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pandas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.pandas" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return a fresh pandas DataFrame conversion (not the cached object).</p>
<p>This is intentionally a fresh conversion so callers who expect an
up-to-date pandas view can access it directly. Use <code>pandas_cached</code> or
<code>to_pandas(force=False)</code> to access the cached conversion for repeated
reads, or <code>to_pandas(force=True)</code> to reconvert and update the cache.</p>
<h4 id="filoma.dataframe.DataFrame.pandas--raises">Raises<a class="headerlink" href="#filoma.dataframe.DataFrame.pandas--raises" title="Permanent link">&para;</a></h4>
<pre><code>ImportError: if pandas is not installed.
</code></pre>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.pandas_cached" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pandas_cached</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.pandas_cached" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return a cached pandas DataFrame, converting once if needed.</p>
<p>This is useful when repeated conversions would be expensive and the
caller is comfortable with an explicit cache that can be invalidated
with <code>invalidate_pandas_cache()</code> or by calling <code>to_pandas(force=True)</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.polars" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">polars</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.polars" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Property access for the underlying Polars DataFrame (convenience).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="filoma.dataframe.DataFrame.shape" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shape</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.shape" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get DataFrame shape (rows, columns).</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__dir__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__dir__</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.__dir__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Expose both wrapper and underlying Polars attributes in interactive help.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Expose both wrapper and underlying Polars attributes in interactive help.&quot;&quot;&quot;</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">())</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">attrs</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__getattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.__getattr__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Delegate attribute access to the underlying Polars DataFrame.</p>
<p>This allows direct access to all Polars DataFrame methods and properties
like columns, dtypes, shape, select, filter, group_by, etc.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegate attribute access to the underlying Polars DataFrame.</span>

<span class="sd">    This allows direct access to all Polars DataFrame methods and properties</span>
<span class="sd">    like columns, dtypes, shape, select, filter, group_by, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Directly return the attribute from the underlying Polars DataFrame.</span>
    <span class="c1"># NOTE: We intentionally do NOT wrap returned Polars DataFrames anymore.</span>
    <span class="c1"># This makes filoma.DataFrame behave like a Polars DataFrame by default</span>
    <span class="c1"># (calls like df.head(), df.select(...), etc. return native Polars</span>
    <span class="c1"># objects). This is a breaking change compared to previously wrapping</span>
    <span class="c1"># Polars results in filoma.DataFrame.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="c1"># Preserve the original error semantics</span>
        <span class="k">raise</span>

    <span class="c1"># If the attribute is callable, return a wrapper that conditionally</span>
    <span class="c1"># wraps returned polars.DataFrame objects into filoma.DataFrame</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">attr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># If the underlying call mutated the Polars DataFrame in-place,</span>
            <span class="c1"># Polars often returns None or the same object reference. In</span>
            <span class="c1"># that case invalidate the cached pandas conversion so future</span>
            <span class="c1"># .pandas/.pandas_cached calls reflect the mutation.</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">result</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="c1"># Best-effort: do not let cache invalidation break calls</span>
                    <span class="k">pass</span>
                <span class="k">return</span> <span class="n">result</span>

            <span class="c1"># If wrapping is enabled and result is a Polars DataFrame,</span>
            <span class="c1"># wrap it back into filoma.DataFrame for compatibility.</span>
            <span class="k">if</span> <span class="n">get_default_wrap_polars</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="c1"># Non-callable attributes (properties)  if it&#39;s a Polars DataFrame and</span>
    <span class="c1"># wrapping is requested, wrap it; otherwise return as-is.</span>
    <span class="k">if</span> <span class="n">get_default_wrap_polars</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">attr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.__getitem__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Forward subscription (e.g., df['path']) to the underlying Polars DataFrame.</p>
<p>Returns native Polars objects (Series or DataFrame) to match the default
Polars-first behavior of this wrapper.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward subscription (e.g., df[&#39;path&#39;]) to the underlying Polars DataFrame.</span>

<span class="sd">    Returns native Polars objects (Series or DataFrame) to match the default</span>
<span class="sd">    Polars-first behavior of this wrapper.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.__init__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Initialize a DataFrame.</p>
        <hr />
<pre><code>data: Initial data. Can be:
    - A Polars DataFrame
    - A dictionary mapping column names to sequences (all same length)
    - A list of string paths
    - A list of Path objects
    - None for an empty DataFrame
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        data: Initial data. Can be:</span>
<span class="sd">            - A Polars DataFrame</span>
<span class="sd">            - A dictionary mapping column names to sequences (all same length)</span>
<span class="sd">            - A list of string paths</span>
<span class="sd">            - A list of Path objects</span>
<span class="sd">            - None for an empty DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="p">[]},</span> <span class="n">schema</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">})</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">processed</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">expected_len</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dictionary values must be list or tuple sequences&quot;</span><span class="p">)</span>
                <span class="n">seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">expected_len</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">expected_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_len</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All dictionary value sequences must have the same length&quot;</span><span class="p">)</span>
                <span class="n">processed</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">processed</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">paths</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;data must be a Polars DataFrame, dict of columns, list of paths, or None&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">with_filename_features</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.__len__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the number of rows in the DataFrame.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the number of rows in the DataFrame.&quot;&quot;&quot;</span>
    <span class="c1"># polars.DataFrame supports len(), but some wrapped/native objects</span>
    <span class="c1"># (for example older PyArrow-backed objects) may not implement __len__.</span>
    <span class="c1"># Try common fallbacks in order of preference.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># polars exposes `.height` as row count and `.shape[0]` as rows</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># Last resort: convert to pandas if available (cheap for small frames)</span>
                <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">return</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.__repr__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the string representation of the DataFrame.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the string representation of the DataFrame.&quot;&quot;&quot;</span>
    <span class="c1"># Avoid calling the underlying object&#39;s __str__/__repr__ if it may</span>
    <span class="c1"># raise TypeError (observed with some PyDataFrame wrappers). Use</span>
    <span class="c1"># safe fallbacks for a short textual preview.</span>
    <span class="n">row_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># Try polars&#39; to_string-like rendering if available</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Polars DataFrame implements __str__/__repr__; prefer repr()</span>
        <span class="n">df_preview</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Try to convert to pandas for a safer repr</span>
            <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">df_preview</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df_preview</span> <span class="o">=</span> <span class="s2">&quot;&lt;unrepresentable DataFrame&gt;&quot;</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">df_preview</span> <span class="o">=</span> <span class="s2">&quot;&lt;unrepresentable DataFrame&gt;&quot;</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;filoma.DataFrame with </span><span class="si">{</span><span class="n">row_count</span><span class="si">}</span><span class="s2"> rows</span><span class="se">\n</span><span class="si">{</span><span class="n">df_preview</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__setitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.__setitem__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Forward item assignment to the underlying Polars DataFrame.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward item assignment to the underlying Polars DataFrame.&quot;&quot;&quot;</span>
    <span class="c1"># Polars DataFrame supports column assignment via df[key] = value</span>
    <span class="c1"># Try to support common user-friendly patterns: assigning a Python</span>
    <span class="c1"># sequence or a Series to create/replace a column. Polars&#39; native</span>
    <span class="c1"># __setitem__ may raise TypeError in some versions, so handle that</span>
    <span class="c1"># explicitly and fall back to with_columns.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># Accept polars Series, pandas Series, or Python sequences</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># pandas Series -&gt; polars Series</span>
                    <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;__array__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                        <span class="n">series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                        <span class="n">series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Scalar value: repeat across rows</span>
                        <span class="n">series</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="n">series</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="s2">&quot;series&quot;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">series</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Use with_columns to add/replace the column</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
                <span class="k">return</span>

        <span class="c1"># Fallback to delegating to Polars __setitem__ for other patterns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="c1"># Underlying data has changed; invalidate any cached pandas conversion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1"># Polars raises TypeError for some unsupported assignment forms</span>
        <span class="c1"># (e.g., assigning a Series by index). Re-raise a clearer message</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;DataFrame object does not support `Series` assignment by index</span><span class="se">\n\n</span><span class="s2">Use `DataFrame.with_columns`.&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.__str__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Return the string representation of the DataFrame.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the string representation of the DataFrame.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.add_depth_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_depth_col</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.add_depth_col" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Add a depth column showing the nesting level of each path.</p>
        <hr />
<pre><code>path: The path to calculate depth from. If None, uses the common root.
inplace: If True, modify this DataFrame in-place and return ``self``.
</code></pre>
        <hr />
<pre><code>New DataFrame with depth column
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_depth_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a depth column showing the nesting level of each path.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        path: The path to calculate depth from. If None, uses the common root.</span>
<span class="sd">        inplace: If True, modify this DataFrame in-place and return ``self``.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">        New DataFrame with depth column</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Find the common root path</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">paths</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Find common parent</span>
            <span class="n">common_parts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">first_parts</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parts</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">part</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">first_parts</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">part</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">):</span>
                    <span class="n">common_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="o">*</span><span class="n">common_parts</span><span class="p">)</span> <span class="k">if</span> <span class="n">common_parts</span> <span class="k">else</span> <span class="n">Path</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># Use a different local name to avoid shadowing the parameter inside calculate_depth</span>
    <span class="n">path_root</span> <span class="o">=</span> <span class="n">path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_depth</span><span class="p">(</span><span class="n">path_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the depth of a path relative to the provided root path.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
            <span class="n">relative_path</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">path_root</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">relative_path</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># Path is not relative to the provided root path</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>

    <span class="n">df_with_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">calculate_depth</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;depth&quot;</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_with_depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_with_depth</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.add_file_stats_cols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_file_stats_cols</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">base_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.add_file_stats_cols" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Add file statistics columns (size, modified time, etc.) based on a column containing filesystem paths.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column containing file system paths.</p>
              </div>
            </td>
            <td>
                  <code>&#39;path&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional base path. If provided, any non-absolute paths in the
path column are resolved relative to this base.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inplace</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, modify this DataFrame in-place and return <code>self</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="filoma.dataframe.DataFrame" href="#filoma.dataframe.DataFrame">DataFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New DataFrame with file statistics columns added, or <code>self</code> when</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="filoma.dataframe.DataFrame" href="#filoma.dataframe.DataFrame">DataFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>inplace=True</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified path column does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_file_stats_cols</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="n">base_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add file statistics columns (size, modified time, etc.) based on a column containing filesystem paths.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Name of the column containing file system paths.</span>
<span class="sd">        base_path: Optional base path. If provided, any non-absolute paths in the</span>
<span class="sd">            path column are resolved relative to this base.</span>
<span class="sd">        inplace: If True, modify this DataFrame in-place and return ``self``.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New DataFrame with file statistics columns added, or ``self`` when</span>
<span class="sd">        ``inplace=True``.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the specified path column does not exist.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame&quot;</span><span class="p">)</span>

    <span class="c1"># Resolve base path if provided</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">base_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">base_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="c1"># Use filoma&#39;s FileProfiler to collect rich file metadata</span>
    <span class="n">profiler</span> <span class="o">=</span> <span class="n">FileProfiler</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_file_stats</span><span class="p">(</span><span class="n">path_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">base</span> <span class="o">/</span> <span class="n">p</span>
            <span class="n">full_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path does not exist: </span><span class="si">{</span><span class="n">full_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">}</span>

            <span class="c1"># Use the profiler; let it handle symlinks and permissions</span>
            <span class="n">filo</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="n">compute_hash</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">filo</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>

            <span class="c1"># Normalize keys to a stable schema used by this helper</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">),</span>
                <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;modified&quot;</span><span class="p">),</span>
                <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;created&quot;</span><span class="p">),</span>
                <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_file&quot;</span><span class="p">),</span>
                <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_dir&quot;</span><span class="p">),</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;owner&quot;</span><span class="p">),</span>
                <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">),</span>
                <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mode_str&quot;</span><span class="p">),</span>
                <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inode&quot;</span><span class="p">),</span>
                <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nlink&quot;</span><span class="p">),</span>
                <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sha256&quot;</span><span class="p">),</span>
                <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;xattrs&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}),</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># On any error, return a row of Nones/empties preserving schema</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">}</span>

    <span class="n">stats_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_file_stats</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">path</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>

    <span class="n">stats_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">stats_data</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;size_bytes&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span>
            <span class="s2">&quot;modified_time&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="s2">&quot;created_time&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="s2">&quot;is_file&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">,</span>
            <span class="s2">&quot;is_dir&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">,</span>
            <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="s2">&quot;mode_str&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="s2">&quot;inode&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span>
            <span class="s2">&quot;nlink&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">Int64</span><span class="p">,</span>
            <span class="s2">&quot;sha256&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="s2">&quot;xattrs&quot;</span><span class="p">:</span> <span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="n">df_with_stats</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">,</span> <span class="n">stats_df</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_with_stats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_with_stats</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.add_filename_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_filename_features</span><span class="p">(</span><span class="n">path_col</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;feat&#39;</span><span class="p">,</span> <span class="n">max_tokens</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_all_parts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">token_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enrich</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.add_filename_features" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Discover filename features and add them as columns on this DataFrame.</p>
<p>This instance method discovers separator-based tokens from filename
stems and adds columns (e.g., <code>feat1</code>, <code>feat2</code> or <code>token1</code>, ...).</p>
        <hr />
<pre><code>path_col: Column containing path strings to analyze (default: 'path').
sep: Separator used to split filename stems (default: '_').
prefix: Column name prefix for discovered tokens (default: 'feat').
max_tokens: Optional cap on extracted tokens; by default uses observed max.
include_parent: If True, add a `parent` column containing immediate parent folder name.
include_all_parts: If True, add `path_part0`, `path_part1`, ... for all Path.parts.
token_names: Optional list of token column names or 'auto' to generate readable names.
enrich: If True, automatically enrich the DataFrame with path components and file stats before discovery.
inplace: If True, perform the operation in-place and return self. Otherwise returns a new `filoma.DataFrame`.
</code></pre>
        <hr />
<pre><code>A new or modified `filoma.DataFrame` with discovered filename features.
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_filename_features</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
    <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span>
    <span class="n">max_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_all_parts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">token_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enrich</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Discover filename features and add them as columns on this DataFrame.</span>

<span class="sd">    This instance method discovers separator-based tokens from filename</span>
<span class="sd">    stems and adds columns (e.g., `feat1`, `feat2` or `token1`, ...).</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        path_col: Column containing path strings to analyze (default: &#39;path&#39;).</span>
<span class="sd">        sep: Separator used to split filename stems (default: &#39;_&#39;).</span>
<span class="sd">        prefix: Column name prefix for discovered tokens (default: &#39;feat&#39;).</span>
<span class="sd">        max_tokens: Optional cap on extracted tokens; by default uses observed max.</span>
<span class="sd">        include_parent: If True, add a `parent` column containing immediate parent folder name.</span>
<span class="sd">        include_all_parts: If True, add `path_part0`, `path_part1`, ... for all Path.parts.</span>
<span class="sd">        token_names: Optional list of token column names or &#39;auto&#39; to generate readable names.</span>
<span class="sd">        enrich: If True, automatically enrich the DataFrame with path components and file stats before discovery.</span>
<span class="sd">        inplace: If True, perform the operation in-place and return self. Otherwise returns a new `filoma.DataFrame`.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">        A new or modified `filoma.DataFrame` with discovered filename features.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Determine the base Polars DataFrame for feature discovery</span>
    <span class="n">base_df</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">if</span> <span class="n">enrich</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Enriching DataFrame before discovering filename features&quot;</span><span class="p">)</span>
        <span class="n">base_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enrich</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Polars-native implementation inlined here (formerly a top-level helper).</span>
    <span class="n">pl_df</span> <span class="o">=</span> <span class="n">base_df</span><span class="o">.</span><span class="n">_df</span>
    <span class="k">if</span> <span class="n">path_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pl_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame must have a &#39;</span><span class="si">{</span><span class="n">path_col</span><span class="si">}</span><span class="s2">&#39; column&quot;</span><span class="p">)</span>

    <span class="n">stems</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">pl_df</span><span class="p">[</span><span class="n">path_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
    <span class="n">split_tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">if</span> <span class="n">stem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">stem</span> <span class="ow">in</span> <span class="n">stems</span><span class="p">]</span>
    <span class="n">observed_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">split_tokens</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_tokens</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">eff_max</span> <span class="o">=</span> <span class="n">observed_max</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">eff_max</span> <span class="o">=</span> <span class="n">max_tokens</span>

    <span class="c1"># Normalize token_names</span>
    <span class="k">if</span> <span class="n">token_names</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
        <span class="n">token_names_seq</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">auto_mode</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">token_names</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">token_names_seq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">token_names</span><span class="p">)</span>
        <span class="n">auto_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">token_names_seq</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">auto_mode</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">new_cols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eff_max</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">token_names_seq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">token_names_seq</span><span class="p">)</span> <span class="ow">and</span> <span class="n">token_names_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">token_names_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">auto_mode</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">prefix</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="s2">&quot;token&quot;</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base</span><span class="si">}{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;token</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">pick_token</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">if</span> <span class="n">st</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">path_col</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">pick_token</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">col_name</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">include_parent</span><span class="p">:</span>
        <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">path_col</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">include_all_parts</span><span class="p">:</span>
        <span class="n">parts_lists</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">pl_df</span><span class="p">[</span><span class="n">path_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
        <span class="n">max_parts</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts_lists</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_parts</span><span class="p">):</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;path_part</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">pick_part</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">parts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s2">&quot;&quot;</span>

            <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">path_col</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="n">pick_part</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Utf8</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">col_name</span><span class="p">))</span>

    <span class="n">pl_result</span> <span class="o">=</span> <span class="n">pl_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span><span class="n">new_cols</span><span class="p">)</span>

    <span class="c1"># Wrap the result in a filoma.DataFrame</span>
    <span class="n">enriched_wrapper</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">pl_result</span><span class="p">)</span>
    <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">with_filename_features</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">_df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_filename_features</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">enrich</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">return</span> <span class="n">enriched_wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.add_path_components" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_path_components</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.add_path_components" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Add columns for path components (parent, name, stem, suffix).</p>
<h4 id="filoma.dataframe.DataFrame.add_path_components--returns">Returns<a class="headerlink" href="#filoma.dataframe.DataFrame.add_path_components--returns" title="Permanent link">&para;</a></h4>
<pre><code>New DataFrame with additional path component columns
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_path_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add columns for path components (parent, name, stem, suffix).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        New DataFrame with additional path component columns</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_with_components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">),</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">),</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">),</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;stem&quot;</span><span class="p">),</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="p">,</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;suffix&quot;</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">df_with_components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df_with_components</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.describe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.describe" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generate descriptive statistics.</p>
        <hr />
<pre><code>percentiles: List of percentiles to include (default: [0.25, 0.5, 0.75])
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate descriptive statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        percentiles: List of percentiles to include (default: [0.25, 0.5, 0.75])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Polars&#39; describe returns a new DataFrame summarizing columns; wrap it</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="n">percentiles</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.enrich" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">enrich</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.enrich" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Enrich the DataFrame by adding features like path components, file stats, and depth.</p>
        <hr />
<pre><code>inplace: If True, perform the operation in-place and return self.
         If False (default), return a new DataFrame with the changes.
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">enrich</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enrich the DataFrame by adding features like path components, file stats, and depth.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        inplace: If True, perform the operation in-place and return self.</span>
<span class="sd">                 If False (default), return a new DataFrame with the changes.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Chain the enrichment methods; this produces a new DataFrame wrapper</span>
    <span class="n">enriched_wrapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_path_components</span><span class="p">()</span><span class="o">.</span><span class="n">add_file_stats_cols</span><span class="p">()</span><span class="o">.</span><span class="n">add_depth_col</span><span class="p">()</span>
    <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="c1"># Update the internal state of the current object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">enriched_wrapper</span><span class="o">.</span><span class="n">_df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_enrich</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_pandas_cache</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># Return the new, enriched DataFrame instance</span>
    <span class="k">return</span> <span class="n">enriched_wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.evaluate_duplicates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_duplicates</span><span class="p">(</span><span class="n">path_col</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">text_threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">image_max_distance</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">text_k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">show_table</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.evaluate_duplicates" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Evaluate duplicates among files in the DataFrame.</p>
<p>Scans the <code>path_col</code> column, runs exact, text and image duplicate
detectors and prints a small Rich table summarizing counts.</p>
<p>Returns the raw dict produced by <code>filoma.dedup.find_duplicates</code>.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_duplicates</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="n">text_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="n">image_max_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">text_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">show_table</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate duplicates among files in the DataFrame.</span>

<span class="sd">    Scans the `path_col` column, runs exact, text and image duplicate</span>
<span class="sd">    detectors and prints a small Rich table summarizing counts.</span>

<span class="sd">    Returns the raw dict produced by `filoma.dedup.find_duplicates`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">path_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">path_col</span><span class="si">}</span><span class="s2">&#39; not found in DataFrame&quot;</span><span class="p">)</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">path_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">_dedup</span><span class="o">.</span><span class="n">find_duplicates</span><span class="p">(</span>
        <span class="n">paths</span><span class="p">,</span>
        <span class="n">text_k</span><span class="o">=</span><span class="n">text_k</span><span class="p">,</span>
        <span class="n">text_threshold</span><span class="o">=</span><span class="n">text_threshold</span><span class="p">,</span>
        <span class="n">image_max_distance</span><span class="o">=</span><span class="n">image_max_distance</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Summarize counts</span>
    <span class="n">exact_groups</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">text_groups</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">image_groups</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">show_table</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Duplicate Summary&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold cyan&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Groups&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Files In Groups&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="s2">&quot;exact&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_groups</span><span class="p">)),</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">exact_groups</span><span class="p">)</span> <span class="k">if</span> <span class="n">exact_groups</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="s2">&quot;text&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text_groups</span><span class="p">)),</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">text_groups</span><span class="p">)</span> <span class="k">if</span> <span class="n">text_groups</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
            <span class="s2">&quot;image&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">image_groups</span><span class="p">)),</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">image_groups</span><span class="p">)</span> <span class="k">if</span> <span class="n">image_groups</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Duplicate summary: exact=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exact_groups</span><span class="p">)</span><span class="si">}</span><span class="s2"> groups &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">exact_groups</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">exact_groups</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2"> files), &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;text=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">text_groups</span><span class="p">)</span><span class="si">}</span><span class="s2"> groups &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">text_groups</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">text_groups</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2"> files), &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;image=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_groups</span><span class="p">)</span><span class="si">}</span><span class="s2"> groups &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">image_groups</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">image_groups</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2"> files)&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.filter_by_extension" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_by_extension</span><span class="p">(</span><span class="n">extensions</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.filter_by_extension" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filter the DataFrame to only include files with specific extensions.</p>
        <hr />
<pre><code>extensions: File extension(s) to filter by (with or without leading dot)
</code></pre>
        <hr />
<pre><code>Filtered DataFrame
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_by_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extensions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter the DataFrame to only include files with specific extensions.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        extensions: File extension(s) to filter by (with or without leading dot)</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">        Filtered DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extensions</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">extensions</span><span class="p">]</span>

    <span class="c1"># Normalize extensions (ensure they start with a dot)</span>
    <span class="n">normalized_extensions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">ext</span>
        <span class="n">normalized_extensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

    <span class="n">filtered_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">normalized_extensions</span><span class="p">,</span>
            <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">Boolean</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.filter_by_pattern" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_by_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.filter_by_pattern" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Filter the DataFrame by path pattern.</p>
        <hr />
<pre><code>pattern: Pattern to match (uses Polars string contains)
</code></pre>
        <hr />
<pre><code>Filtered DataFrame
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_by_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter the DataFrame by path pattern.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        pattern: Pattern to match (uses Polars string contains)</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">        Filtered DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filtered_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pattern</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.from_pandas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#filoma.dataframe.DataFrame.from_pandas" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Construct a filoma.DataFrame from a pandas DataFrame.</p>
<p>This is a convenience wrapper that converts the pandas DataFrame into
a Polars DataFrame and wraps it. Requires pandas to be installed.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_pandas</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a filoma.DataFrame from a pandas DataFrame.</span>

<span class="sd">    This is a convenience wrapper that converts the pandas DataFrame into</span>
<span class="sd">    a Polars DataFrame and wraps it. Requires pandas to be installed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;pandas is not available in this environment&quot;</span><span class="p">)</span>
    <span class="c1"># Convert via Polars for internal consistency</span>
    <span class="n">pl_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">pl_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.group_by_directory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">group_by_directory</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.group_by_directory" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Group files by their parent directory and count them.</p>
<h4 id="filoma.dataframe.DataFrame.group_by_directory--returns">Returns<a class="headerlink" href="#filoma.dataframe.DataFrame.group_by_directory--returns" title="Permanent link">&para;</a></h4>
<pre><code>Polars DataFrame with directory counts
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">group_by_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Group files by their parent directory and count them.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Polars DataFrame with directory counts</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># underlying `_df` is expected to be a Polars DataFrame</span>
    <span class="n">df_with_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">),</span> <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;parent_dir&quot;</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">df_with_parent</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;parent_dir&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;len&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.group_by_extension" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">group_by_extension</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.group_by_extension" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Group files by extension and count them.</p>
<h4 id="filoma.dataframe.DataFrame.group_by_extension--returns">Returns<a class="headerlink" href="#filoma.dataframe.DataFrame.group_by_extension--returns" title="Permanent link">&para;</a></h4>
<pre><code>Polars DataFrame with extension counts
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">group_by_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Group files by extension and count them.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Polars DataFrame with extension counts</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># underlying `_df` is expected to be a Polars DataFrame</span>
    <span class="n">df_with_ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map_elements</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="k">else</span> <span class="s2">&quot;&lt;no extension&gt;&quot;</span><span class="p">),</span>
                <span class="n">return_dtype</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">String</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;extension&quot;</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">df_with_ext</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;extension&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;len&quot;</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.head" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.head" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the first n rows.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the first n rows.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">info</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.info" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Print concise summary of the DataFrame.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print concise summary of the DataFrame.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;filoma.DataFrame&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Columns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Column info</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column details:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)):</span>
        <span class="n">null_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">null_count</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">col</span><span class="si">:</span><span class="s2">15s</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="si">:</span><span class="s2">15s</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">null_count</span><span class="si">:</span><span class="s2">8d</span><span class="si">}</span><span class="s2"> nulls&quot;</span><span class="p">)</span>

    <span class="c1"># Memory usage approximation</span>
    <span class="n">memory_mb</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">estimated_size</span><span class="p">(</span><span class="s2">&quot;mb&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Estimated memory usage: </span><span class="si">{</span><span class="n">memory_mb</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.invalidate_pandas_cache" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">invalidate_pandas_cache</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.invalidate_pandas_cache" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Clear the cached pandas conversion created by <code>to_pandas()</code>.</p>
<p>Call this after mutating the underlying Polars DataFrame to ensure
subsequent <code>pandas</code> accesses reflect the latest data.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">invalidate_pandas_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear the cached pandas conversion created by `to_pandas()`.</span>

<span class="sd">    Call this after mutating the underlying Polars DataFrame to ensure</span>
<span class="sd">    subsequent `pandas` accesses reflect the latest data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.save_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.save_csv" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Save the DataFrame to CSV.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the DataFrame to CSV.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.save_parquet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_parquet</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.save_parquet" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Save the DataFrame to Parquet format.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_parquet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the DataFrame to Parquet format.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">write_parquet</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.sort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.sort" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Sort the DataFrame.</p>
        <hr />
<pre><code>by: Column name(s) to sort by
descending: Sort in descending order
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort the DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        by: Column name(s) to sort by</span>
<span class="sd">        descending: Sort in descending order</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">descending</span><span class="o">=</span><span class="n">descending</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.split_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_data</span><span class="p">(</span><span class="n">train_val_test</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">feature</span><span class="o">=</span><span class="s1">&#39;path_parts&#39;</span><span class="p">,</span> <span class="n">path_parts</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">discover</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">feat_prefix</span><span class="o">=</span><span class="s1">&#39;feat&#39;</span><span class="p">,</span> <span class="n">max_tokens</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_all_parts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">token_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path_col</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;filoma&#39;</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.split_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Deterministically split this filoma DataFrame into train/val/test.</p>
<p>This is a thin wrapper around <code>filoma.ml.split_data</code> so you can call
<code>df.split_data(...)</code> directly on a filoma DataFrame instance.</p>
<p>Args mirror :func:<code>filoma.ml.split_data</code> except <code>df</code> is implicit.</p>
<p>By default <code>return_type='filoma'</code> so the three returned objects are
filoma.DataFrame wrappers.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">train_val_test</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">feature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;path_parts&quot;</span><span class="p">,</span>
    <span class="n">path_parts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
    <span class="n">feat_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span>
    <span class="n">max_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_all_parts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">token_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">path_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;filoma&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deterministically split this filoma DataFrame into train/val/test.</span>

<span class="sd">    This is a thin wrapper around ``filoma.ml.split_data`` so you can call</span>
<span class="sd">    ``df.split_data(...)`` directly on a filoma DataFrame instance.</span>

<span class="sd">    Args mirror :func:`filoma.ml.split_data` except ``df`` is implicit.</span>

<span class="sd">    By default ``return_type=&#39;filoma&#39;`` so the three returned objects are</span>
<span class="sd">    filoma.DataFrame wrappers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Local import to avoid loading ml utilities unless used</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">ml</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">ml</span><span class="o">.</span><span class="n">split_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">train_val_test</span><span class="o">=</span><span class="n">train_val_test</span><span class="p">,</span>
        <span class="n">feature</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span>
        <span class="n">path_parts</span><span class="o">=</span><span class="n">path_parts</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="n">discover</span><span class="o">=</span><span class="n">discover</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
        <span class="n">feat_prefix</span><span class="o">=</span><span class="n">feat_prefix</span><span class="p">,</span>
        <span class="n">max_tokens</span><span class="o">=</span><span class="n">max_tokens</span><span class="p">,</span>
        <span class="n">include_parent</span><span class="o">=</span><span class="n">include_parent</span><span class="p">,</span>
        <span class="n">include_all_parts</span><span class="o">=</span><span class="n">include_all_parts</span><span class="p">,</span>
        <span class="n">token_names</span><span class="o">=</span><span class="n">token_names</span><span class="p">,</span>
        <span class="n">path_col</span><span class="o">=</span><span class="n">path_col</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">return_type</span><span class="o">=</span><span class="n">return_type</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.tail" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.tail" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the last n rows.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the last n rows.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.to_dict" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert to a dictionary.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to a dictionary.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">as_series</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.to_pandas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_pandas</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.to_pandas" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Convert to a pandas DataFrame.</p>
<p>By default this method will return a cached pandas conversion if one
exists (for performance). Set <code>force=True</code> to reconvert from the
current Polars DataFrame and update the cache.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to a pandas DataFrame.</span>

<span class="sd">    By default this method will return a cached pandas conversion if one</span>
<span class="sd">    exists (for performance). Set ``force=True`` to reconvert from the</span>
<span class="sd">    current Polars DataFrame and update the cache.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;pandas is not installed. Please install it to use to_pandas().&quot;</span><span class="p">)</span>
    <span class="c1"># Convert and cache on first access or when forced</span>
    <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Use Polars&#39; to_pandas conversion for consistency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pd_cache</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.to_polars" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_polars</span><span class="p">()</span></code>

<a href="#filoma.dataframe.DataFrame.to_polars" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the underlying Polars DataFrame.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the underlying Polars DataFrame.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="filoma.dataframe.DataFrame.unique" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#filoma.dataframe.DataFrame.unique" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get unique rows.</p>
        <hr />
<pre><code>subset: Column name(s) to consider for uniqueness
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/dataframe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get unique rows.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        subset: Column name(s) to consider for uniqueness</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="ml-helpers">ML helpers<a class="headerlink" href="#ml-helpers" title="Permanent link">&para;</a></h2>
<p>Utilities used for dataset splitting and feature handling.</p>


<div class="doc doc-object doc-module">



<a id="filoma.ml"></a>
    <div class="doc doc-contents first">

        <p>Simple ML-style utilities for filoma DataFrame splitting.</p>
<p>Provides an intuitive split_data API to split a filoma.DataFrame into train/val/test
based on filename/path-derived features. The goal is a tiny, dependency-free,
user-friendly interface using pathlib.Path to select path parts.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="filoma.ml.split_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">train_val_test</span><span class="o">=</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">feature</span><span class="o">=</span><span class="s1">&#39;path_parts&#39;</span><span class="p">,</span> <span class="n">path_parts</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">discover</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">feat_prefix</span><span class="o">=</span><span class="s1">&#39;feat&#39;</span><span class="p">,</span> <span class="n">max_tokens</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_all_parts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">token_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path_col</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">validate_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;filoma&#39;</span><span class="p">)</span></code>

<a href="#filoma.ml.split_data" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Split a filoma DataFrame into train/val/test based on filename/path-derived features.</p>
<h4 id="filoma.ml.split_data--parameters">Parameters<a class="headerlink" href="#filoma.ml.split_data--parameters" title="Permanent link">&para;</a></h4>
<p>data : Union[pl.DataFrame, Any]
    A Polars DataFrame or filoma.DataFrame wrapper containing a 'path' column.
train_val_test : tuple[float, float, float]
    Three integers or ratios for train/val/test; they will be normalized to fractions.
feature : Union[str, Sequence[str]]
    Which feature to use for grouping. May be a sequence of column names
    (group by existing columns), a single column name string, or one of
    'path_parts', 'filename', 'stem', 'parent', 'suffix' to derive the feature from <code>path_col</code>.
path_parts : Optional[Iterable[int]]
    Iterable selecting indices in Path.parts (supports negative indices). Only used
    when <code>feature=='path_parts'</code>. Default picks -1 (filename).
seed : Optional[int]
    Optional integer to alter hashing for reproducible, different splits.
random_state : Optional[int]
    Alias for <code>seed</code> (if provided it takes precedence).
discover : bool
    If True, automatically discover filename tokens and add columns named
    <code>prefix1</code>, <code>prefix2</code>, ... (or <code>token1</code>... if prefix=None).
sep : str
    Separator used to split filename stems when <code>discover=True</code>.
feat_prefix : str
    Prefix to use for discovered token column names. If None, names will be
    <code>token1</code>, <code>token2</code>, ...
token_names : Optional[Union[str, Sequence[str]]]
    Optional list of column names to use for tokens, or 'auto' to automatically
    generate readable names (uses prefix if set).
max_tokens : Optional[int]
    Maximum number of tokens to extract when discovering.
include_parent : bool
    If True, add a <code>parent</code> column with the immediate parent folder name.
include_all_parts : bool
    If True, add columns <code>path_part0</code>, <code>path_part1</code>, ... for all Path.parts.
verbose : bool
    If True (default) log a short warning when achieved split counts differ noticeably
    from requested ratios (common with small datasets or grouped features).
validate_counts : bool
    If True, log a warning when the set of unique feature values (or combined-column
    feature) is not identical across the train/val/test splits.
return_type : str
    One of 'polars' (default), 'filoma' (wrap Polars into filoma.DataFrame), or
    'pandas' (convert to pandas.DataFrame). If 'pandas' is chosen, pandas must be available.
path_col : str
    Column name in the input DataFrame containing file paths used for deriving features.</p>
<h4 id="filoma.ml.split_data--returns">Returns<a class="headerlink" href="#filoma.ml.split_data--returns" title="Permanent link">&para;</a></h4>
<pre><code>    tuple: (train_df, val_df, test_df) as Polars DataFrames.

Note:
    Splits are deterministic and grouped by the chosen feature to avoid
    leaking similar files into multiple sets when they share the same feature.
    The method uses sha256 hashing of the feature string to map to [0,1).
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/ml.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">split_data</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">train_val_test</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">feature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;path_parts&quot;</span><span class="p">,</span>
    <span class="n">path_parts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span>
    <span class="n">feat_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;feat&quot;</span><span class="p">,</span>
    <span class="n">max_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_all_parts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">token_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">path_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">validate_counts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;filoma&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split a filoma DataFrame into train/val/test based on filename/path-derived features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : Union[pl.DataFrame, Any]</span>
<span class="sd">        A Polars DataFrame or filoma.DataFrame wrapper containing a &#39;path&#39; column.</span>
<span class="sd">    train_val_test : tuple[float, float, float]</span>
<span class="sd">        Three integers or ratios for train/val/test; they will be normalized to fractions.</span>
<span class="sd">    feature : Union[str, Sequence[str]]</span>
<span class="sd">        Which feature to use for grouping. May be a sequence of column names</span>
<span class="sd">        (group by existing columns), a single column name string, or one of</span>
<span class="sd">        &#39;path_parts&#39;, &#39;filename&#39;, &#39;stem&#39;, &#39;parent&#39;, &#39;suffix&#39; to derive the feature from `path_col`.</span>
<span class="sd">    path_parts : Optional[Iterable[int]]</span>
<span class="sd">        Iterable selecting indices in Path.parts (supports negative indices). Only used</span>
<span class="sd">        when `feature==&#39;path_parts&#39;`. Default picks -1 (filename).</span>
<span class="sd">    seed : Optional[int]</span>
<span class="sd">        Optional integer to alter hashing for reproducible, different splits.</span>
<span class="sd">    random_state : Optional[int]</span>
<span class="sd">        Alias for `seed` (if provided it takes precedence).</span>
<span class="sd">    discover : bool</span>
<span class="sd">        If True, automatically discover filename tokens and add columns named</span>
<span class="sd">        `prefix1`, `prefix2`, ... (or `token1`... if prefix=None).</span>
<span class="sd">    sep : str</span>
<span class="sd">        Separator used to split filename stems when `discover=True`.</span>
<span class="sd">    feat_prefix : str</span>
<span class="sd">        Prefix to use for discovered token column names. If None, names will be</span>
<span class="sd">        `token1`, `token2`, ...</span>
<span class="sd">    token_names : Optional[Union[str, Sequence[str]]]</span>
<span class="sd">        Optional list of column names to use for tokens, or &#39;auto&#39; to automatically</span>
<span class="sd">        generate readable names (uses prefix if set).</span>
<span class="sd">    max_tokens : Optional[int]</span>
<span class="sd">        Maximum number of tokens to extract when discovering.</span>
<span class="sd">    include_parent : bool</span>
<span class="sd">        If True, add a `parent` column with the immediate parent folder name.</span>
<span class="sd">    include_all_parts : bool</span>
<span class="sd">        If True, add columns `path_part0`, `path_part1`, ... for all Path.parts.</span>
<span class="sd">    verbose : bool</span>
<span class="sd">        If True (default) log a short warning when achieved split counts differ noticeably</span>
<span class="sd">        from requested ratios (common with small datasets or grouped features).</span>
<span class="sd">    validate_counts : bool</span>
<span class="sd">        If True, log a warning when the set of unique feature values (or combined-column</span>
<span class="sd">        feature) is not identical across the train/val/test splits.</span>
<span class="sd">    return_type : str</span>
<span class="sd">        One of &#39;polars&#39; (default), &#39;filoma&#39; (wrap Polars into filoma.DataFrame), or</span>
<span class="sd">        &#39;pandas&#39; (convert to pandas.DataFrame). If &#39;pandas&#39; is chosen, pandas must be available.</span>
<span class="sd">    path_col : str</span>
<span class="sd">        Column name in the input DataFrame containing file paths used for deriving features.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">            tuple: (train_df, val_df, test_df) as Polars DataFrames.</span>

<span class="sd">        Note:</span>
<span class="sd">            Splits are deterministic and grouped by the chosen feature to avoid</span>
<span class="sd">            leaking similar files into multiple sets when they share the same feature.</span>
<span class="sd">            The method uses sha256 hashing of the feature string to map to [0,1).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">train_val_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_val_test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;train_val_test must be a tuple of three numbers&quot;</span>

    <span class="c1"># Accept filoma.DataFrame wrapper or raw Polars DataFrame; discovery</span>
    <span class="c1"># (if requested) will wrap raw frames into filoma.DataFrame. Defer the</span>
    <span class="c1"># `path_col` existence check until after discovery to avoid unwrapping</span>
    <span class="c1"># the filoma.DataFrame more than once.</span>

    <span class="n">ratios</span> <span class="o">=</span> <span class="n">_normalize_ratios</span><span class="p">(</span><span class="n">train_val_test</span><span class="p">)</span>

    <span class="c1"># Discovery: return a filoma.DataFrame wrapper (or wrap the input if not discovering)</span>
    <span class="n">df_work</span> <span class="o">=</span> <span class="n">_maybe_discover</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">discover</span><span class="o">=</span><span class="n">discover</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
        <span class="n">feat_prefix</span><span class="o">=</span><span class="n">feat_prefix</span><span class="p">,</span>
        <span class="n">max_tokens</span><span class="o">=</span><span class="n">max_tokens</span><span class="p">,</span>
        <span class="n">include_parent</span><span class="o">=</span><span class="n">include_parent</span><span class="p">,</span>
        <span class="n">include_all_parts</span><span class="o">=</span><span class="n">include_all_parts</span><span class="p">,</span>
        <span class="n">token_names</span><span class="o">=</span><span class="n">token_names</span><span class="p">,</span>
        <span class="n">path_col</span><span class="o">=</span><span class="n">path_col</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Extract the underlying Polars DataFrame for downstream processing</span>
    <span class="n">pl_work</span> <span class="o">=</span> <span class="n">df_work</span><span class="o">.</span><span class="n">df</span>

    <span class="k">if</span> <span class="n">path_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pl_work</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame must have a &#39;</span><span class="si">{</span><span class="n">path_col</span><span class="si">}</span><span class="s2">&#39; column&quot;</span><span class="p">)</span>

    <span class="c1"># Feature grouping &amp; assignment</span>
    <span class="n">feature_to_idxs</span><span class="p">,</span> <span class="n">paths</span> <span class="o">=</span> <span class="n">_build_feature_index</span><span class="p">(</span><span class="n">pl_work</span><span class="p">,</span> <span class="n">path_col</span><span class="o">=</span><span class="n">path_col</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">path_parts</span><span class="o">=</span><span class="n">path_parts</span><span class="p">)</span>
    <span class="c1"># Determine effective seed: prefer `random_state` if provided for sklearn-like API</span>
    <span class="n">effective_seed</span> <span class="o">=</span> <span class="n">random_state</span> <span class="k">if</span> <span class="n">random_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">seed</span>
    <span class="n">feature_assignment</span> <span class="o">=</span> <span class="n">_assign_features</span><span class="p">(</span><span class="n">feature_to_idxs</span><span class="p">,</span> <span class="n">ratios</span><span class="o">=</span><span class="n">ratios</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">effective_seed</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">_mask_from_assignment</span><span class="p">(</span><span class="n">feature_to_idxs</span><span class="p">,</span> <span class="n">feature_assignment</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">pl_work</span><span class="o">.</span><span class="n">with_columns</span><span class="p">([</span><span class="n">pl</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="s2">&quot;_split&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="p">)])</span>

    <span class="c1"># Feature column for user convenience</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">_add_feature_column</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">path_col</span><span class="o">=</span><span class="n">path_col</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">path_parts</span><span class="o">=</span><span class="n">path_parts</span><span class="p">)</span>

    <span class="c1"># Split</span>
    <span class="n">train_df</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_split&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;train&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_split&quot;</span><span class="p">)</span>
    <span class="n">val_df</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_split&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;val&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_split&quot;</span><span class="p">)</span>
    <span class="n">test_df</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_split&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_split&quot;</span><span class="p">)</span>

    <span class="c1"># Validate that the unique feature values are represented equally across splits</span>
    <span class="k">if</span> <span class="n">validate_counts</span><span class="p">:</span>
        <span class="n">PATH_MODES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_parts&quot;</span><span class="p">,</span> <span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="s2">&quot;stem&quot;</span><span class="p">,</span> <span class="s2">&quot;parent&quot;</span><span class="p">,</span> <span class="s2">&quot;suffix&quot;</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">feature</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PATH_MODES</span> <span class="ow">and</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">pl_work</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">feat_col</span> <span class="o">=</span> <span class="s2">&quot;_feat_group&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">feat_col</span> <span class="o">=</span> <span class="s2">&quot;_feat_path_parts&quot;</span> <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s2">&quot;path_parts&quot;</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;_feat_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">train_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="n">feat_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
            <span class="n">val_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">val_df</span><span class="p">[</span><span class="n">feat_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
            <span class="n">test_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">test_df</span><span class="p">[</span><span class="n">feat_col</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># If something unexpected happens (missing column), skip validation</span>
            <span class="n">train_set</span> <span class="o">=</span> <span class="n">val_set</span> <span class="o">=</span> <span class="n">test_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">train_set</span> <span class="o">==</span> <span class="n">val_set</span> <span class="o">==</span> <span class="n">test_set</span><span class="p">):</span>
            <span class="n">union</span> <span class="o">=</span> <span class="n">train_set</span> <span class="o">|</span> <span class="n">val_set</span> <span class="o">|</span> <span class="n">test_set</span>
            <span class="n">missing_in_train</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">union</span> <span class="o">-</span> <span class="n">train_set</span><span class="p">))[:</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">missing_in_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">union</span> <span class="o">-</span> <span class="n">val_set</span><span class="p">))[:</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">missing_in_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">union</span> <span class="o">-</span> <span class="n">test_set</span><span class="p">))[:</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="s2">&quot;filoma.ml.split_data: unique feature values differ across splits for &#39;</span><span class="si">{}</span><span class="s2">&#39; -&quot;</span>
                    <span class="s2">&quot; counts train=</span><span class="si">{}</span><span class="s2">, val=</span><span class="si">{}</span><span class="s2">, test=</span><span class="si">{}</span><span class="s2">; examples missing_in_train=</span><span class="si">{}</span><span class="s2">,&quot;</span>
                    <span class="s2">&quot; missing_in_val=</span><span class="si">{}</span><span class="s2">, missing_in_test=</span><span class="si">{}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
                <span class="n">feat_col</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">train_set</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">val_set</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">test_set</span><span class="p">),</span>
                <span class="n">missing_in_train</span><span class="p">,</span>
                <span class="n">missing_in_val</span><span class="p">,</span>
                <span class="n">missing_in_test</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="n">_maybe_log_ratio_drift</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span> <span class="n">ratios</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>

    <span class="c1"># Return requested type (default: filoma.DataFrame wrappers)</span>
    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;filoma&quot;</span> <span class="ow">or</span> <span class="n">return_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Lazy import filoma.DataFrame wrapper to avoid heavy imports at module import time</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.dataframe</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">FDataFrame</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">filoma.dataframe</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">FDataFrame</span>

        <span class="k">return</span> <span class="n">FDataFrame</span><span class="p">(</span><span class="n">train_df</span><span class="p">),</span> <span class="n">FDataFrame</span><span class="p">(</span><span class="n">val_df</span><span class="p">),</span> <span class="n">FDataFrame</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;polars&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">train_df</span><span class="p">,</span> <span class="n">val_df</span><span class="p">,</span> <span class="n">test_df</span>

    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;pandas&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">train_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">val_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">test_df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to convert to pandas DataFrame: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown return_type=&#39;</span><span class="si">{</span><span class="n">return_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="directory-profiler">Directory profiler<a class="headerlink" href="#directory-profiler" title="Permanent link">&para;</a></h2>
<p>The directory profiling API and configuration helpers.</p>


<div class="doc doc-object doc-module">



<a id="filoma.directories.directory_profiler"></a>
    <div class="doc doc-contents first">

        <p>Directory profiling utilities.</p>
<p>This module provides :class:<code>DirectoryProfiler</code> which analyzes directory
trees and returns a :class:<code>DirectoryAnalysis</code> dataclass with summary
statistics and optional DataFrame support.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="filoma.directories.directory_profiler.DirectoryAnalysis" class="doc doc-heading">
            <code>DirectoryAnalysis</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="collections.abc.Mapping">Mapping</span></code></p>


        <p>Structured container for directory analysis results.</p>
<p>This is the canonical, dataclass-first return value for directory probes.
Use :meth:<code>to_dict</code> to convert to a plain dict and :meth:<code>to_df</code>
to access the optional DataFrame. The class exists to provide a typed,
ergonomic API for programmatic consumption.</p>








              <details class="quote">
                <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DirectoryAnalysis</span><span class="p">(</span><span class="n">Mapping</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Structured container for directory analysis results.</span>

<span class="sd">    This is the canonical, dataclass-first return value for directory probes.</span>
<span class="sd">    Use :meth:`to_dict` to convert to a plain dict and :meth:`to_df`</span>
<span class="sd">    to access the optional DataFrame. The class exists to provide a typed,</span>
<span class="sd">    ergonomic API for programmatic consumption.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">summary</span><span class="p">:</span> <span class="n">Dict</span>
    <span class="n">file_extensions</span><span class="p">:</span> <span class="n">Dict</span>
    <span class="n">common_folder_names</span><span class="p">:</span> <span class="n">Dict</span>
    <span class="n">empty_folders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">top_folders_by_file_count</span><span class="p">:</span> <span class="n">List</span>
    <span class="n">depth_distribution</span><span class="p">:</span> <span class="n">Dict</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;DataFrame&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timing</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dataframe_note</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a :class:`DirectoryAnalysis` from a plain dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        d : dict</span>
<span class="sd">            Dictionary in the shape produced by :meth:`DirectoryProfiler.probe`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DirectoryAnalysis</span>
<span class="sd">            Constructed dataclass instance.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">),</span>
            <span class="n">summary</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="p">{}),</span>
            <span class="n">file_extensions</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_extensions&quot;</span><span class="p">,</span> <span class="p">{}),</span>
            <span class="n">common_folder_names</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;common_folder_names&quot;</span><span class="p">,</span> <span class="p">{}),</span>
            <span class="n">empty_folders</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;empty_folders&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="n">top_folders_by_file_count</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;top_folders_by_file_count&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="n">depth_distribution</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;depth_distribution&quot;</span><span class="p">,</span> <span class="p">{}),</span>
            <span class="n">dataframe</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dataframe&quot;</span><span class="p">),</span>
            <span class="n">timing</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timing&quot;</span><span class="p">),</span>
            <span class="n">dataframe_note</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dataframe_note&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a plain ``dict`` representation of this analysis.&quot;&quot;&quot;</span>
        <span class="c1"># Convert to a plain dict shape</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
            <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span>
            <span class="s2">&quot;file_extensions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_extensions</span><span class="p">,</span>
            <span class="s2">&quot;common_folder_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">common_folder_names</span><span class="p">,</span>
            <span class="s2">&quot;empty_folders&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_folders</span><span class="p">,</span>
            <span class="s2">&quot;top_folders_by_file_count&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_folders_by_file_count</span><span class="p">,</span>
            <span class="s2">&quot;depth_distribution&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_distribution</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;timing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_note</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;dataframe_note&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_note</span>
        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;DataFrame&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the attached DataFrame wrapper or log a helpful warning when absent.</span>

<span class="sd">        This method used to silently return None when no DataFrame was built which</span>
<span class="sd">        often confused interactive users calling ``analysis.to_df()``. We now log a</span>
<span class="sd">        warning explaining the likely causes (DataFrame building disabled or polars</span>
<span class="sd">        not installed) to surface actionable next steps.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Emit a helpful, actionable warning rather than silently returning None</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No DataFrame available for analysis at path </span><span class="si">{path!s}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;DataFrame building is disabled by default or &#39;polars&#39; is not installed. &quot;</span>
                <span class="s2">&quot;Call DirectoryProfiler(build_dataframe=True) or use filoma.probe_to_df(...) to obtain a DataFrame.&quot;</span><span class="p">,</span>
                <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :meth:`to_dict`.</span>

<span class="sd">        Provided for backward compatibility with dict-based APIs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="c1"># Convenience printing helpers so callers can write `analysis.print_summary()`</span>
    <span class="c1"># or `analysis.print_report()` without importing DirectoryProfiler. These</span>
    <span class="c1"># delegate to the existing DirectoryProfiler rich printers for consistency.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profiler</span><span class="p">:</span> <span class="s2">&quot;DirectoryProfiler&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pretty-print a short summary using the rich-based DirectoryProfiler printer.</span>

<span class="sd">        If `profiler` is provided it will be used (useful to customize show_progress,</span>
<span class="sd">        console, or other profiler settings); otherwise a default profiler is created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Local import to avoid import cycles at module import time</span>
        <span class="k">if</span> <span class="n">profiler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">profiler</span> <span class="o">=</span> <span class="n">DirectoryProfiler</span><span class="p">()</span>
        <span class="n">profiler</span><span class="o">.</span><span class="n">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profiler</span><span class="p">:</span> <span class="s2">&quot;DirectoryProfiler&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pretty-print the full report (summary + extras) via DirectoryProfiler.</span>

<span class="sd">        This is an alias for `print_summary` + additional report sections; kept</span>
<span class="sd">        as a separate method name for discoverability and symmetry with other</span>
<span class="sd">        profilers in the project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">profiler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">profiler</span> <span class="o">=</span> <span class="n">DirectoryProfiler</span><span class="p">()</span>
        <span class="n">profiler</span><span class="o">.</span><span class="n">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Mapping protocol implementations so callers can still use dict-like access</span>
    <span class="c1"># (e.g., result[&#39;summary&#39;]) even though the canonical return type is a dataclass.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping-style access to analysis fields by key.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_dict</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over analysis mapping keys.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_dict</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return number of top-level fields in the analysis mapping.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_dict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__getitem__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Mapping-style access to analysis fields by key.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mapping-style access to analysis fields by key.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_dict</span><span class="p">()[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__iter__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Iterate over analysis mapping keys.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over analysis mapping keys.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_dict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return number of top-level fields in the analysis mapping.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return number of top-level fields in the analysis mapping.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_as_dict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.as_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_dict</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.as_dict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Alias for :meth:<code>to_dict</code>.</p>
<p>Provided for backward compatibility with dict-based APIs.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Alias for :meth:`to_dict`.</span>

<span class="sd">    Provided for backward compatibility with dict-based APIs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.from_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a :class:<code>DirectoryAnalysis</code> from a plain dict.</p>
<h5 id="filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--parameters">Parameters<a class="headerlink" href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--parameters" title="Permanent link">&para;</a></h5>
<p>d : dict
    Dictionary in the shape produced by :meth:<code>DirectoryProfiler.probe</code>.</p>
<h5 id="filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--returns">Returns<a class="headerlink" href="#filoma.directories.directory_profiler.DirectoryAnalysis.from_dict--returns" title="Permanent link">&para;</a></h5>
<p>DirectoryAnalysis
    Constructed dataclass instance.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a :class:`DirectoryAnalysis` from a plain dict.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : dict</span>
<span class="sd">        Dictionary in the shape produced by :meth:`DirectoryProfiler.probe`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DirectoryAnalysis</span>
<span class="sd">        Constructed dataclass instance.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">),</span>
        <span class="n">summary</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">,</span> <span class="p">{}),</span>
        <span class="n">file_extensions</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_extensions&quot;</span><span class="p">,</span> <span class="p">{}),</span>
        <span class="n">common_folder_names</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;common_folder_names&quot;</span><span class="p">,</span> <span class="p">{}),</span>
        <span class="n">empty_folders</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;empty_folders&quot;</span><span class="p">,</span> <span class="p">[]),</span>
        <span class="n">top_folders_by_file_count</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;top_folders_by_file_count&quot;</span><span class="p">,</span> <span class="p">[]),</span>
        <span class="n">depth_distribution</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;depth_distribution&quot;</span><span class="p">,</span> <span class="p">{}),</span>
        <span class="n">dataframe</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dataframe&quot;</span><span class="p">),</span>
        <span class="n">timing</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timing&quot;</span><span class="p">),</span>
        <span class="n">dataframe_note</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dataframe_note&quot;</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.print_report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_report</span><span class="p">(</span><span class="n">profiler</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.print_report" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pretty-print the full report (summary + extras) via DirectoryProfiler.</p>
<p>This is an alias for <code>print_summary</code> + additional report sections; kept
as a separate method name for discoverability and symmetry with other
profilers in the project.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profiler</span><span class="p">:</span> <span class="s2">&quot;DirectoryProfiler&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pretty-print the full report (summary + extras) via DirectoryProfiler.</span>

<span class="sd">    This is an alias for `print_summary` + additional report sections; kept</span>
<span class="sd">    as a separate method name for discoverability and symmetry with other</span>
<span class="sd">    profilers in the project.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">profiler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">profiler</span> <span class="o">=</span> <span class="n">DirectoryProfiler</span><span class="p">()</span>
    <span class="n">profiler</span><span class="o">.</span><span class="n">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.print_summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_summary</span><span class="p">(</span><span class="n">profiler</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.print_summary" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pretty-print a short summary using the rich-based DirectoryProfiler printer.</p>
<p>If <code>profiler</code> is provided it will be used (useful to customize show_progress,
console, or other profiler settings); otherwise a default profiler is created.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profiler</span><span class="p">:</span> <span class="s2">&quot;DirectoryProfiler&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pretty-print a short summary using the rich-based DirectoryProfiler printer.</span>

<span class="sd">    If `profiler` is provided it will be used (useful to customize show_progress,</span>
<span class="sd">    console, or other profiler settings); otherwise a default profiler is created.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Local import to avoid import cycles at module import time</span>
    <span class="k">if</span> <span class="n">profiler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">profiler</span> <span class="o">=</span> <span class="n">DirectoryProfiler</span><span class="p">()</span>
    <span class="n">profiler</span><span class="o">.</span><span class="n">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_df</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.to_df" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the attached DataFrame wrapper or log a helpful warning when absent.</p>
<p>This method used to silently return None when no DataFrame was built which
often confused interactive users calling <code>analysis.to_df()</code>. We now log a
warning explaining the likely causes (DataFrame building disabled or polars
not installed) to surface actionable next steps.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;DataFrame&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the attached DataFrame wrapper or log a helpful warning when absent.</span>

<span class="sd">    This method used to silently return None when no DataFrame was built which</span>
<span class="sd">    often confused interactive users calling ``analysis.to_df()``. We now log a</span>
<span class="sd">    warning explaining the likely causes (DataFrame building disabled or polars</span>
<span class="sd">    not installed) to surface actionable next steps.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Emit a helpful, actionable warning rather than silently returning None</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;No DataFrame available for analysis at path </span><span class="si">{path!s}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;DataFrame building is disabled by default or &#39;polars&#39; is not installed. &quot;</span>
            <span class="s2">&quot;Call DirectoryProfiler(build_dataframe=True) or use filoma.probe_to_df(...) to obtain a DataFrame.&quot;</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryAnalysis.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryAnalysis.to_dict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a plain <code>dict</code> representation of this analysis.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a plain ``dict`` representation of this analysis.&quot;&quot;&quot;</span>
    <span class="c1"># Convert to a plain dict shape</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
        <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span>
        <span class="s2">&quot;file_extensions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_extensions</span><span class="p">,</span>
        <span class="s2">&quot;common_folder_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">common_folder_names</span><span class="p">,</span>
        <span class="s2">&quot;empty_folders&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_folders</span><span class="p">,</span>
        <span class="s2">&quot;top_folders_by_file_count&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_folders_by_file_count</span><span class="p">,</span>
        <span class="s2">&quot;depth_distribution&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_distribution</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;timing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_note</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;dataframe_note&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_note</span>
    <span class="k">return</span> <span class="n">d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="filoma.directories.directory_profiler.DirectoryProfiler" class="doc doc-heading">
            <code>DirectoryProfiler</code>


<a href="#filoma.directories.directory_profiler.DirectoryProfiler" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Analyzes directory structures for basic statistics and patterns.</p>
<p>Provides file counts, folder patterns, empty directories, and extension analysis.</p>
<p>Can use either a pure Python implementation or a faster Rust implementation
when available. Supports both sequential and parallel Rust processing.</p>








              <details class="quote">
                <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DirectoryProfiler</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyzes directory structures for basic statistics and patterns.</span>

<span class="sd">    Provides file counts, folder patterns, empty directories, and extension analysis.</span>

<span class="sd">    Can use either a pure Python implementation or a faster Rust implementation</span>
<span class="sd">    when available. Supports both sequential and parallel Rust processing.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="s2">&quot;DirectoryProfilerConfig&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the directory profiler.</span>

<span class="sd">        The profiler is configured with a `DirectoryProfilerConfig` instance which</span>
<span class="sd">        holds options such as whether to use Rust acceleration, parallel processing,</span>
<span class="sd">        fd integration, thresholding for parallelism, DataFrame building, and progress</span>
<span class="sd">        reporting callbacks. Pass a `DirectoryProfilerConfig` object as the single</span>
<span class="sd">        `config` argument. See `DirectoryProfilerConfig` for descriptions of each</span>
<span class="sd">        configurable field.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Expect a DirectoryProfilerConfig object  no legacy kwargs supported.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;__class__&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">config</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;DirectoryProfilerConfig&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DirectoryProfiler requires a DirectoryProfilerConfig instance as the sole argument&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>

        <span class="c1"># Set simple aliases for common flags to preserve prior attribute names</span>
        <span class="c1"># Internal availability checks are still performed below.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">search_backend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">parallel_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fast_path_only</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">fast_path_only</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_callback</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">progress_callback</span>

        <span class="c1"># Validate availability and enforce clear relationships</span>
        <span class="c1"># Use explicit booleans from the config</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Rust implementation requested but not available in this build&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Parallel Rust requested but not available&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">RUST_ASYNC_AVAILABLE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Async Rust prober requested but not available in this build&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;fd integration requested but not available in this environment&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;DataFrame building requested but Polars/DataFrame support is not available&quot;</span><span class="p">)</span>

        <span class="c1"># Network args only apply when use_async is True (explicit)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">config</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">!=</span> <span class="mi">64</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">!=</span> <span class="mi">5000</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Network tuning parameters only apply when use_async=True&quot;</span><span class="p">)</span>

        <span class="c1"># Threads only applies when use_fd is True</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">threads</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;threads&#39; setting only applies when use_fd=True&quot;</span><span class="p">)</span>

        <span class="c1"># Decide which implementation to use based on search_backend and availability</span>
        <span class="n">backend_choice</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">search_backend</span>
        <span class="k">if</span> <span class="n">backend_choice</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="c1"># Honor explicit user preferences when provided.</span>
            <span class="c1"># If both backends are explicitly requested and available, prefer fd</span>
            <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span> <span class="ow">and</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
                <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;fd&quot;</span>
            <span class="c1"># If user explicitly requested Rust and it&#39;s available, use it</span>
            <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
                <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;rust&quot;</span>
            <span class="c1"># If user explicitly requested fd and it&#39;s available, use it</span>
            <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
                <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;fd&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># No explicit preference from user -&gt; auto-detect best available</span>
                <span class="k">if</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
                    <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;rust&quot;</span>
                <span class="k">elif</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
                    <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;fd&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;python&quot;</span>

        <span class="k">if</span> <span class="n">backend_choice</span> <span class="o">==</span> <span class="s2">&quot;rust&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">backend_choice</span> <span class="o">==</span> <span class="s2">&quot;fd&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Parallel/async/other toggles come directly from config (already validated)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_async</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span><span class="p">)</span>

        <span class="c1"># Other instance-level flags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">build_dataframe</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">)</span>
        <span class="c1"># Progress handling</span>
        <span class="k">if</span> <span class="n">_is_interactive_environment</span><span class="p">()</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Interactive environment detected, disabling progress bars to avoid conflicts&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">show_progress</span><span class="p">)</span>

        <span class="c1"># Network tuning (only valid if use_async True)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">network_concurrency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">network_timeout_ms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">network_retries</span>

        <span class="c1"># Threads forwarded to fd if using fd backend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threads</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">threads</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Defer fd integration initialization until actually used</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_rust_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if Rust implementation is available and being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            True if Rust implementation is available and enabled, False otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="n">RUST_AVAILABLE</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_parallel_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if parallel Rust implementation is available and being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            True if parallel Rust implementation is available and enabled, False otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="n">RUST_PARALLEL_AVAILABLE</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_fd_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if fd integration is available and being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            True if fd is available and enabled, False otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use FD_AVAILABLE to reflect whether the fd integration package is importable</span>
        <span class="c1"># Tests may monkeypatch FD_AVAILABLE without having the fd binary present.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_implementation_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get information about which implementations are available and being used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Dictionary with implementation availability status</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;rust_available&quot;</span><span class="p">:</span> <span class="n">RUST_AVAILABLE</span><span class="p">,</span>
            <span class="s2">&quot;rust_parallel_available&quot;</span><span class="p">:</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">,</span>
            <span class="s2">&quot;rust_async_available&quot;</span><span class="p">:</span> <span class="n">RUST_ASYNC_AVAILABLE</span><span class="p">,</span>
            <span class="s2">&quot;fd_available&quot;</span><span class="p">:</span> <span class="n">FD_AVAILABLE</span><span class="p">,</span>
            <span class="s2">&quot;dataframe_available&quot;</span><span class="p">:</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">,</span>
            <span class="s2">&quot;using_rust&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span><span class="p">,</span>
            <span class="s2">&quot;using_parallel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span><span class="p">,</span>
            <span class="s2">&quot;using_async&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="n">RUST_ASYNC_AVAILABLE</span><span class="p">),</span>
            <span class="s2">&quot;using_fd&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span><span class="p">,</span>
            <span class="s2">&quot;using_dataframe&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span><span class="p">,</span>
            <span class="s2">&quot;return_absolute_paths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
            <span class="s2">&quot;search_backend&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span><span class="p">,</span>
            <span class="s2">&quot;python_fallback&quot;</span><span class="p">:</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">probe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze a directory tree and return comprehensive statistics.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            path: Path to the root directory to probe</span>
<span class="sd">            max_depth: Maximum depth to traverse (None for unlimited)</span>
<span class="sd">            threads: Optional override for number of threads when using fd backend</span>

<span class="sd">        Returns:</span>
<span class="sd">        -------</span>
<span class="sd">            A :class:`DirectoryAnalysis` instance containing analysis results</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Choose the best backend</span>
        <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_backend</span><span class="p">()</span>

        <span class="c1"># Log the start of analysis</span>
        <span class="n">impl_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_impl_display_name</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting directory analysis of &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; using </span><span class="si">{</span><span class="n">impl_type</span><span class="si">}</span><span class="s2"> implementation&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;fd&quot;</span><span class="p">:</span>
                <span class="c1"># threads param overrides instance threads when provided</span>
                <span class="n">chosen_threads</span> <span class="o">=</span> <span class="n">threads</span> <span class="k">if</span> <span class="n">threads</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">threads</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_fd</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">chosen_threads</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;rust&quot;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_rust</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">fast_path_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fast_path_only</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_python</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>

            <span class="c1"># Calculate and log timing</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">total_items</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">][</span><span class="s2">&quot;total_files&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">][</span><span class="s2">&quot;total_folders&quot;</span><span class="p">]</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Directory analysis completed in </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s - &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="n">total_items</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> items (</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_files&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_folders&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> folders) using </span><span class="si">{</span><span class="n">impl_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="c1"># Add timing information to result</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;timing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;elapsed_seconds&quot;</span><span class="p">:</span> <span class="n">elapsed_time</span><span class="p">,</span>
                <span class="s2">&quot;implementation&quot;</span><span class="p">:</span> <span class="n">impl_type</span><span class="p">,</span>
                <span class="s2">&quot;items_per_second&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">total_items</span> <span class="o">/</span> <span class="n">elapsed_time</span> <span class="k">if</span> <span class="n">elapsed_time</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">}</span>

            <span class="c1"># Return a structured dataclass by default for easier programmatic use</span>
            <span class="k">return</span> <span class="n">DirectoryAnalysis</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Directory analysis failed after </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_choose_backend</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Choose the best available backend based on settings and availability.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Backend name: &quot;fd&quot;, &quot;rust&quot;, or &quot;python&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If search_backend is &#39;auto&#39; and neither rust nor fd are requested</span>
        <span class="c1"># by the resolved preferences, prefer the Python backend. This avoids</span>
        <span class="c1"># forcing Python when the user specifically preferred fd.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;python&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;fd&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;fd&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;fd backend requested but not available, falling back to auto selection&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;rust&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;rust&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Rust backend requested but not available, falling back to auto selection&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;python&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;python&quot;</span>

        <span class="c1"># Auto selection logic</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="c1"># Based on cold cache benchmarks Rust tends to be the fastest</span>
            <span class="c1"># general-purpose backend. Prefer Rust when available; fall back</span>
            <span class="c1"># to fd when Rust is not enabled/available but fd is explicitly</span>
            <span class="c1"># enabled by the user.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;rust&quot;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;fd&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;python&quot;</span>

        <span class="c1"># Fallback to python if nothing else works</span>
        <span class="k">return</span> <span class="s2">&quot;python&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_impl_display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get display name for implementation type.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;fd&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot; fd&quot;</span>
        <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;rust&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot; Rust (Parallel)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot; Rust (Sequential)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot; Python&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_probe_fd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use fd for file discovery + Python for analysis.</span>

<span class="sd">        This hybrid approach leverages fd&#39;s ultra-fast file discovery</span>
<span class="sd">        while using Python for statistical analysis to maintain</span>
<span class="sd">        consistency with other backends.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Lazily initialize fd integration here. This ensures tests that</span>
        <span class="c1"># monkeypatch FD_AVAILABLE can control availability without the</span>
        <span class="c1"># constructor eagerly probing the environment.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># If the fd integration package wasn&#39;t importable at module</span>
            <span class="c1"># import time, reflect that now.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;fd integration not available&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span> <span class="o">=</span> <span class="n">FdIntegration</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                    <span class="c1"># fd binary is not usable on this system</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;fd integration not available&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;fd integration not available&quot;</span><span class="p">)</span>

        <span class="n">progress</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">task_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
                <span class="n">SpinnerColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[bold blue]Discovering files with fd...&quot;</span><span class="p">),</span>
                <span class="n">BarColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[progress.percentage]</span><span class="si">{task.percentage:&gt;3.0f}</span><span class="s2">%&quot;</span><span class="p">),</span>
                <span class="n">TimeElapsedColumn</span><span class="p">(),</span>
                <span class="n">console</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="p">,</span>
                <span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">task_id</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;Discovering...&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Run the fd discovery and analysis inside a try so we always stop</span>
        <span class="c1"># the progress bar in the finally block below.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Use fd to get all files and directories rapidly</span>
            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold blue]Finding files...&quot;</span><span class="p">)</span>

            <span class="c1"># fd&#39;s --max-depth applies to the matched path; to match the</span>
            <span class="c1"># Python/Rust semantics where files up to depth (max_depth + 1)</span>
            <span class="c1"># are included, when a max_depth is provided for the probe we</span>
            <span class="c1"># increase the file search depth by 1.</span>
            <span class="n">file_max_depth</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">max_depth</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="c1"># When using fd in auto mode, prefer flags that match a raw</span>
            <span class="c1"># traversal (include hidden files, don&#39;t honor ignore files, follow symlinks)</span>
            <span class="n">fd_find_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
                <span class="s2">&quot;file_types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span>
                <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="n">file_max_depth</span><span class="p">,</span>
                <span class="s2">&quot;absolute_paths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
                <span class="s2">&quot;threads&quot;</span><span class="p">:</span> <span class="n">threads</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
                <span class="n">fd_find_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;search_hidden&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;no_ignore&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;follow_links&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

            <span class="n">all_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="o">**</span><span class="n">fd_find_kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold blue]Finding directories...&quot;</span><span class="p">)</span>

            <span class="n">all_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">],</span>  <span class="c1"># Directories only</span>
                <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
                <span class="n">absolute_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
                <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">,</span>
                <span class="n">search_hidden</span><span class="o">=</span><span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">no_ignore</span><span class="o">=</span><span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">follow_links</span><span class="o">=</span><span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Convert to Path objects for analysis</span>
            <span class="n">root_path_obj</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
            <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_files</span> <span class="o">+</span> <span class="n">all_dirs</span><span class="p">]</span>

            <span class="c1"># If DataFrame building is enabled and DataFrame support is available,</span>
            <span class="c1"># build a prebuilt DataFrame from the fd results and pass it to the</span>
            <span class="c1"># Python probing logic to avoid rebuilding the DataFrame there.</span>
            <span class="n">prebuilt_df</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">prebuilt_df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_paths</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="c1"># If DataFrame construction fails for any reason, fall back</span>
                    <span class="c1"># to letting _probe_paths_python collect paths itself.</span>
                    <span class="n">prebuilt_df</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold yellow]Analyzing discovered files...&quot;</span><span class="p">)</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">completed</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

                <span class="c1"># Now probe the discovered paths using Python logic</span>
                <span class="c1"># Pass the existing progress to avoid conflicts. If a prebuilt DataFrame</span>
                <span class="c1"># exists, provide it to avoid rebuilding the DataFrame inside the probe.</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_paths_python</span><span class="p">(</span>
                    <span class="n">root_path_obj</span><span class="p">,</span>
                    <span class="n">all_paths</span><span class="p">,</span>
                    <span class="n">max_depth</span><span class="p">,</span>
                    <span class="n">existing_progress</span><span class="o">=</span><span class="n">progress</span><span class="p">,</span>
                    <span class="n">existing_task_id</span><span class="o">=</span><span class="n">task_id</span><span class="p">,</span>
                    <span class="n">prebuilt_dataframe</span><span class="o">=</span><span class="n">prebuilt_df</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># No progress provided; run probe without progress integration</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_paths_python</span><span class="p">(</span>
                    <span class="n">root_path_obj</span><span class="p">,</span>
                    <span class="n">all_paths</span><span class="p">,</span>
                    <span class="n">max_depth</span><span class="p">,</span>
                    <span class="n">existing_progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">existing_task_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">prebuilt_dataframe</span><span class="o">=</span><span class="n">prebuilt_df</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold green]Analysis complete!&quot;</span><span class="p">)</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">completed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sample_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return small samples of paths for quick backend-diffing.</span>

<span class="sd">        Returns a dict with keys &#39;fd_files&#39;, &#39;fd_dirs&#39;, &#39;python_files&#39;. Rust currently</span>
<span class="sd">        does not expose a path list in the public API so it is omitted (you can</span>
<span class="sd">        re-run the Rust prober separately if needed).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fd_files&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;fd_dirs&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;python_files&quot;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
                <span class="n">fd</span> <span class="o">=</span> <span class="n">FdIntegration</span><span class="p">()</span>
                <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span>
                    <span class="n">max_results</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
                    <span class="n">search_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">no_ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">follow_links</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">absolute_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_dirs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                    <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                    <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">],</span>
                    <span class="n">max_results</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
                    <span class="n">search_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">no_ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">follow_links</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">absolute_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_dirs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Python sample</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">python_files</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                    <span class="n">python_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">python_files</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">sample_size</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;python_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">python_files</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;python_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">samples</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_probe_paths_python</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
        <span class="n">all_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">existing_progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">existing_task_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">prebuilt_dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze pre-discovered paths using Python logic.</span>

<span class="sd">        This method takes a list of paths (from fd or other source) and performs</span>
<span class="sd">        the statistical analysis to maintain consistency with the Python backend.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            path: Root directory being probed</span>
<span class="sd">            all_paths: List of paths to probe</span>
<span class="sd">            max_depth: Maximum depth for analysis</span>
<span class="sd">            existing_progress: Existing progress bar to reuse (avoids conflicts)</span>
<span class="sd">            existing_task_id: Existing task ID to update</span>
<span class="sd">            path_root: The resolved root Path for the probe (used for depth calculations)</span>
<span class="sd">            prebuilt_dataframe: Optional DataFrame supplied to avoid rebuilding inside probe</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize counters and collections</span>
        <span class="n">file_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">folder_count</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Start with 1 to count the root directory itself</span>
        <span class="n">total_size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">empty_folders</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">file_extensions</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">folder_names</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">files_per_folder</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">depth_stats</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Count the root directory at depth 0</span>
        <span class="n">depth_stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Collection for DataFrame if enabled. If a prebuilt_dataframe is provided</span>
        <span class="c1"># (e.g. from fd results), skip collecting paths and attach it at the end.</span>
        <span class="n">dataframe_paths</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">prebuilt_dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Sort paths for better progress indication (guard against None or unsortable lists)</span>
        <span class="k">if</span> <span class="n">all_paths</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">all_paths</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># If sorting fails (e.g., mixed types), ignore and proceed</span>
                <span class="k">pass</span>

        <span class="n">progress</span> <span class="o">=</span> <span class="n">existing_progress</span>
        <span class="n">task_id</span> <span class="o">=</span> <span class="n">existing_task_id</span>
        <span class="n">processed_items</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">progress_owned</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Track if we own the progress bar</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="ow">and</span> <span class="n">existing_progress</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Only create new progress if none was provided</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
                <span class="n">SpinnerColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[bold blue]Analyzing file metadata...&quot;</span><span class="p">),</span>
                <span class="n">BarColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[progress.percentage]</span><span class="si">{task.percentage:&gt;3.0f}</span><span class="s2">%&quot;</span><span class="p">),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">{task.completed:,}</span><span class="s2">/</span><span class="si">{task.total:,}</span><span class="s2"> items)&quot;</span><span class="p">),</span>
                <span class="n">TimeElapsedColumn</span><span class="p">(),</span>
                <span class="n">console</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="p">,</span>
                <span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">task_id</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;Analyzing...&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">all_paths</span><span class="p">))</span>
            <span class="n">progress_owned</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">existing_progress</span> <span class="ow">and</span> <span class="n">existing_task_id</span><span class="p">:</span>
            <span class="c1"># Update existing progress for the analysis phase</span>
            <span class="n">existing_progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="n">existing_task_id</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold yellow]Analyzing file metadata...&quot;</span><span class="p">,</span>
                <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">all_paths</span><span class="p">),</span>
                <span class="n">completed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">current_path</span> <span class="ow">in</span> <span class="n">all_paths</span><span class="p">:</span>
                <span class="n">processed_items</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Update progress</span>
                <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">processed_items</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">completed</span><span class="o">=</span><span class="n">processed_items</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_callback</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">progress_callback</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Processing: </span><span class="si">{</span><span class="n">current_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">processed_items</span><span class="p">,</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">all_paths</span><span class="p">),</span>
                        <span class="p">)</span>

                <span class="c1"># Calculate current depth</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">depth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">path_root</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="c1"># Skip if beyond max depth (should not happen with fd filtering, but safety check)</span>
                <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">continue</span>

                <span class="c1"># Add to paths collection if DataFrame is enabled and we&#39;re collecting paths</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">dataframe_paths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">dataframe_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">current_path</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                    <span class="n">depth_stats</span><span class="p">[</span><span class="n">depth</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">folder_count</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Check for empty folders</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">current_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()):</span>
                            <span class="n">empty_folders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">current_path</span><span class="p">))</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                        <span class="k">pass</span>

                    <span class="c1"># Analyze folder names for patterns</span>
                    <span class="n">folder_names</span><span class="p">[</span><span class="n">current_path</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">elif</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                    <span class="n">file_count</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Count files in parent directory</span>
                    <span class="n">files_per_folder</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">current_path</span><span class="o">.</span><span class="n">parent</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Get file extension</span>
                    <span class="n">ext</span> <span class="o">=</span> <span class="n">current_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">ext</span><span class="p">:</span>
                        <span class="n">file_extensions</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">file_extensions</span><span class="p">[</span><span class="s2">&quot;&lt;no extension&gt;&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Add to total size</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">total_size</span> <span class="o">+=</span> <span class="n">current_path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">IOError</span><span class="p">):</span>
                        <span class="k">pass</span>

            <span class="c1"># Final progress update</span>
            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">completed</span><span class="o">=</span><span class="n">processed_items</span><span class="p">)</span>

            <span class="c1"># Calculate summary statistics</span>
            <span class="n">avg_files_per_folder</span> <span class="o">=</span> <span class="n">file_count</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">folder_count</span><span class="p">)</span>

            <span class="c1"># Find folders with most files</span>
            <span class="n">top_folders_by_file_count</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files_per_folder</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>

            <span class="c1"># Build result dictionary</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">path_root</span><span class="p">),</span>
                <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;total_files&quot;</span><span class="p">:</span> <span class="n">file_count</span><span class="p">,</span>
                    <span class="s2">&quot;total_folders&quot;</span><span class="p">:</span> <span class="n">folder_count</span><span class="p">,</span>
                    <span class="s2">&quot;total_size_bytes&quot;</span><span class="p">:</span> <span class="n">total_size</span><span class="p">,</span>
                    <span class="s2">&quot;total_size_mb&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="s2">&quot;avg_files_per_folder&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">avg_files_per_folder</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">depth_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">depth_stats</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;empty_folder_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">),</span>
                <span class="p">},</span>
                <span class="s2">&quot;file_extensions&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">file_extensions</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)),</span>
                <span class="s2">&quot;common_folder_names&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">folder_names</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)),</span>
                <span class="s2">&quot;empty_folders&quot;</span><span class="p">:</span> <span class="n">empty_folders</span><span class="p">,</span>
                <span class="s2">&quot;top_folders_by_file_count&quot;</span><span class="p">:</span> <span class="n">top_folders_by_file_count</span><span class="p">,</span>
                <span class="s2">&quot;depth_distribution&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">depth_stats</span><span class="p">),</span>
            <span class="p">}</span>

            <span class="c1"># Add DataFrame if enabled</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prebuilt_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Use prebuilt DataFrame supplied by caller (fd results)</span>
                    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prebuilt_dataframe</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">dataframe_paths</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">progress_owned</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_probe_rust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fast_path_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use the Rust implementation for analysis.</span>

<span class="sd">        For performance, the main statistical analysis is done in Rust.</span>
<span class="sd">        If DataFrame building is enabled, file paths are collected separately</span>
<span class="sd">        using Python/pathlib to maintain consistency with the Python implementation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">task_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
                <span class="n">SpinnerColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[bold blue]Analyzing directory structure...&quot;</span><span class="p">),</span>
                <span class="n">BarColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[progress.percentage]</span><span class="si">{task.percentage:&gt;3.0f}</span><span class="s2">%&quot;</span><span class="p">),</span>
                <span class="n">TimeElapsedColumn</span><span class="p">(),</span>
                <span class="n">console</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="p">,</span>
                <span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Remove progress bar when done</span>
            <span class="p">)</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">task_id</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;Analyzing...&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Choose Rust variant: async for network filesystems, sync otherwise</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fs_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detect_filesystem_type</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">fs_type</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">is_network_fs</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">fs_type</span><span class="p">:</span>
                <span class="c1"># Common network FS types</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">fs_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;nfs&quot;</span><span class="p">,</span> <span class="s2">&quot;cifs&quot;</span><span class="p">,</span> <span class="s2">&quot;smb&quot;</span><span class="p">,</span> <span class="s2">&quot;ceph&quot;</span><span class="p">,</span> <span class="s2">&quot;gluster&quot;</span><span class="p">,</span> <span class="s2">&quot;sshfs&quot;</span><span class="p">)):</span>
                    <span class="n">is_network_fs</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># If network FS choose async Rust prober which limits concurrency and uses tokio</span>
            <span class="c1"># Only use the async Rust variant when the path looks like a network</span>
            <span class="c1"># filesystem AND the user explicitly enabled async via `use_async`.</span>
            <span class="k">if</span> <span class="n">is_network_fs</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_async</span><span class="p">:</span>
                <span class="c1"># Default concurrency limit can be tuned; use configured values</span>
                <span class="k">if</span> <span class="n">RUST_ASYNC_AVAILABLE</span><span class="p">:</span>
                    <span class="c1"># Decide Rust flag defaults: when search_backend is &#39;auto&#39;, prefer fd-like semantics</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
                        <span class="n">follow</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">hidden</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">follow</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">hidden</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">result</span> <span class="o">=</span> <span class="n">probe_directory_rust_async</span><span class="p">(</span>
                        <span class="n">path</span><span class="p">,</span>
                        <span class="n">max_depth</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout_ms</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">network_retries</span><span class="p">,</span>
                        <span class="n">fast_path_only</span><span class="p">,</span>
                        <span class="n">follow_links</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                        <span class="n">search_hidden</span><span class="o">=</span><span class="n">hidden</span><span class="p">,</span>
                        <span class="n">no_ignore</span><span class="o">=</span><span class="n">no_ignore</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Async variant not available; fall back to parallel or sequential Rust</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
                            <span class="n">follow</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">hidden</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">follow</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="n">hidden</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">None</span>

                        <span class="n">result</span> <span class="o">=</span> <span class="n">probe_directory_rust_parallel</span><span class="p">(</span>
                            <span class="n">path</span><span class="p">,</span>
                            <span class="n">max_depth</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span><span class="p">,</span>
                            <span class="n">fast_path_only</span><span class="p">,</span>
                            <span class="n">follow_links</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                            <span class="n">search_hidden</span><span class="o">=</span><span class="n">hidden</span><span class="p">,</span>
                            <span class="n">no_ignore</span><span class="o">=</span><span class="n">no_ignore</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">probe_directory_rust</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">fast_path_only</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_network_fs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_async</span><span class="p">:</span>
                <span class="c1"># User explicitly disabled async; prefer parallel or sequential Rust</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
                        <span class="n">follow</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">hidden</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">follow</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">hidden</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">result</span> <span class="o">=</span> <span class="n">probe_directory_rust_parallel</span><span class="p">(</span>
                        <span class="n">path</span><span class="p">,</span>
                        <span class="n">max_depth</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span><span class="p">,</span>
                        <span class="n">fast_path_only</span><span class="p">,</span>
                        <span class="n">follow_links</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                        <span class="n">search_hidden</span><span class="o">=</span><span class="n">hidden</span><span class="p">,</span>
                        <span class="n">no_ignore</span><span class="o">=</span><span class="n">no_ignore</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
                        <span class="n">follow</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">hidden</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">follow</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">hidden</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="n">result</span> <span class="o">=</span> <span class="n">probe_directory_rust</span><span class="p">(</span>
                        <span class="n">path</span><span class="p">,</span>
                        <span class="n">max_depth</span><span class="p">,</span>
                        <span class="n">fast_path_only</span><span class="p">,</span>
                        <span class="n">follow_links</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                        <span class="n">search_hidden</span><span class="o">=</span><span class="n">hidden</span><span class="p">,</span>
                        <span class="n">no_ignore</span><span class="o">=</span><span class="n">no_ignore</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
                    <span class="n">follow</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">follow</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">no_ignore</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">probe_directory_rust_parallel</span><span class="p">(</span>
                        <span class="n">path</span><span class="p">,</span>
                        <span class="n">max_depth</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span><span class="p">,</span>
                        <span class="n">fast_path_only</span><span class="p">,</span>
                        <span class="n">follow_links</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                        <span class="n">search_hidden</span><span class="o">=</span><span class="n">hidden</span><span class="p">,</span>
                        <span class="n">no_ignore</span><span class="o">=</span><span class="n">no_ignore</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">probe_directory_rust</span><span class="p">(</span>
                        <span class="n">path</span><span class="p">,</span>
                        <span class="n">max_depth</span><span class="p">,</span>
                        <span class="n">fast_path_only</span><span class="p">,</span>
                        <span class="n">follow_links</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                        <span class="n">search_hidden</span><span class="o">=</span><span class="n">hidden</span><span class="p">,</span>
                        <span class="n">no_ignore</span><span class="o">=</span><span class="n">no_ignore</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="c1"># Update progress to show completion</span>
            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold green]Analysis complete!&quot;</span><span class="p">)</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">completed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

            <span class="c1"># Rust now returns absolute (or canonicalized when follow_links=True) paths,</span>
            <span class="c1"># so Python-side normalization is no longer necessary here.</span>

            <span class="c1"># If DataFrame building is enabled, we need to collect file paths</span>
            <span class="c1"># since the Rust implementation doesn&#39;t return them</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold yellow]Building DataFrame...&quot;</span><span class="p">)</span>

                <span class="n">root_path_obj</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">permission_errors_encountered</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="c1"># Collect paths using Python (pathlib) with error handling for system directories</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">current_path</span> <span class="ow">in</span> <span class="n">root_path_obj</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># Calculate current depth</span>
                            <span class="n">depth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">root_path_obj</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>

                            <span class="c1"># Skip if beyond max depth</span>
                            <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth</span><span class="p">:</span>
                                <span class="k">continue</span>

                            <span class="n">all_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">current_path</span><span class="p">))</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                            <span class="c1"># Skip paths that can&#39;t be accessed or processed</span>
                            <span class="n">permission_errors_encountered</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">continue</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">,</span> <span class="ne">FileNotFoundError</span><span class="p">):</span>
                    <span class="c1"># If rglob fails entirely, provide DataFrame with whatever we collected</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;[yellow]Warning: Some paths couldn&#39;t be accessed for DataFrame building[/yellow]&quot;</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame building encountered permission errors on </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">, providing partial results&quot;</span><span class="p">)</span>
                    <span class="n">permission_errors_encountered</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="c1"># Add DataFrame to the result (may be partial if there were permission errors)</span>
                <span class="n">result</span><span class="p">[</span><span class="s2">&quot;dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">all_paths</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">permission_errors_encountered</span><span class="p">:</span>
                    <span class="c1"># Add a note only if we actually encountered permission errors</span>
                    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;dataframe_note&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DataFrame may be incomplete due to permission restrictions&quot;</span>

                <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;[bold green]DataFrame built!&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_probe_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pure Python implementation with enhanced DataFrame support and progress indication.&quot;&quot;&quot;</span>
        <span class="n">path_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path_root</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path does not exist: </span><span class="si">{</span><span class="n">path_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path_root</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Path is not a directory: </span><span class="si">{</span><span class="n">path_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Initialize counters and collections</span>
        <span class="n">file_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">folder_count</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Start with 1 to count the root directory itself</span>
        <span class="n">total_size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">empty_folders</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">file_extensions</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">folder_names</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">files_per_folder</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">depth_stats</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Count the root directory at depth 0</span>
        <span class="n">depth_stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Collection for DataFrame if enabled</span>
        <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Estimate total items for progress tracking</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">task_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">total_items</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">processed_items</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
            <span class="c1"># Quick estimation pass</span>
            <span class="n">total_items</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">path_root</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">))</span>

            <span class="n">progress</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
                <span class="n">SpinnerColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[bold blue]Analyzing directory structure...&quot;</span><span class="p">),</span>
                <span class="n">BarColumn</span><span class="p">(),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;[progress.percentage]</span><span class="si">{task.percentage:&gt;3.0f}</span><span class="s2">%&quot;</span><span class="p">),</span>
                <span class="n">TextColumn</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">{task.completed:,}</span><span class="s2">/</span><span class="si">{task.total:,}</span><span class="s2"> items)&quot;</span><span class="p">),</span>
                <span class="n">TimeElapsedColumn</span><span class="p">(),</span>
                <span class="n">console</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="p">,</span>
                <span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">task_id</span> <span class="o">=</span> <span class="n">progress</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s2">&quot;Analyzing...&quot;</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">total_items</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Walk through directory tree using pathlib for consistency</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">current_path</span> <span class="ow">in</span> <span class="n">path_root</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">processed_items</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="c1"># Update progress</span>
                        <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">processed_items</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Update every 100 items for performance</span>
                                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">completed</span><span class="o">=</span><span class="n">processed_items</span><span class="p">)</span>

                            <span class="c1"># Call custom progress callback if provided</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_callback</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">progress_callback</span><span class="p">(</span>
                                    <span class="sa">f</span><span class="s2">&quot;Processing: </span><span class="si">{</span><span class="n">current_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                    <span class="n">processed_items</span><span class="p">,</span>
                                    <span class="n">total_items</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="p">)</span>

                        <span class="c1"># Calculate current depth</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">depth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">path_root</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span>

                        <span class="c1"># Skip if beyond max depth (match Rust implementation logic)</span>
                        <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth</span><span class="p">:</span>
                                    <span class="k">continue</span>
                                <span class="k">elif</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                                    <span class="k">continue</span>
                            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                                <span class="c1"># Skip paths we can&#39;t access for depth checking</span>
                                <span class="k">continue</span>

                        <span class="c1"># Add to paths collection if DataFrame is enabled</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span><span class="p">:</span>
                            <span class="n">all_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">current_path</span><span class="p">))</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">is_dir</span> <span class="o">=</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span>
                            <span class="n">is_file</span> <span class="o">=</span> <span class="n">current_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                            <span class="c1"># Skip paths we can&#39;t determine type for</span>
                            <span class="k">continue</span>

                        <span class="k">if</span> <span class="n">is_dir</span><span class="p">:</span>
                            <span class="n">depth_stats</span><span class="p">[</span><span class="n">depth</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">folder_count</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="c1"># Check for empty folders</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">current_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()):</span>
                                    <span class="n">empty_folders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">current_path</span><span class="p">))</span>
                            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                                <span class="c1"># Skip directories we can&#39;t read</span>
                                <span class="k">pass</span>

                            <span class="c1"># Analyze folder names for patterns</span>
                            <span class="n">folder_names</span><span class="p">[</span><span class="n">current_path</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="k">elif</span> <span class="n">is_file</span><span class="p">:</span>
                            <span class="n">file_count</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="c1"># Count files in parent directory</span>
                            <span class="n">files_per_folder</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">current_path</span><span class="o">.</span><span class="n">parent</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="c1"># Get file extension</span>
                            <span class="n">ext</span> <span class="o">=</span> <span class="n">current_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                            <span class="k">if</span> <span class="n">ext</span><span class="p">:</span>
                                <span class="n">file_extensions</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">file_extensions</span><span class="p">[</span><span class="s2">&quot;&lt;no extension&gt;&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="c1"># Add to total size</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">total_size</span> <span class="o">+=</span> <span class="n">current_path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
                            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">IOError</span><span class="p">):</span>
                                <span class="c1"># Skip files we can&#39;t stat (permissions, broken symlinks, etc.)</span>
                                <span class="k">pass</span>

                    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                        <span class="c1"># Skip individual files/directories we can&#39;t access</span>
                        <span class="k">continue</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">):</span>
                <span class="c1"># If rglob fails entirely, we can&#39;t probe this directory</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[yellow]Warning: Cannot access directory </span><span class="si">{</span><span class="n">path_root</span><span class="si">}</span><span class="s2"> - insufficient permissions[/yellow]&quot;</span><span class="p">)</span>
                <span class="c1"># Return minimal result</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">path_root</span><span class="p">),</span>
                    <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;total_files&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;total_folders&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;total_size_bytes&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;total_size_mb&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                        <span class="s2">&quot;avg_files_per_folder&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                        <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;empty_folder_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;file_extensions&quot;</span><span class="p">:</span> <span class="p">{},</span>
                    <span class="s2">&quot;common_folder_names&quot;</span><span class="p">:</span> <span class="p">{},</span>
                    <span class="s2">&quot;empty_folders&quot;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="s2">&quot;top_folders_by_file_count&quot;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="s2">&quot;depth_distribution&quot;</span><span class="p">:</span> <span class="p">{},</span>
                    <span class="s2">&quot;timing&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Permission denied&quot;</span><span class="p">},</span>
                <span class="p">}</span>

            <span class="c1"># Final progress update</span>
            <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">task_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">completed</span><span class="o">=</span><span class="n">processed_items</span><span class="p">)</span>

            <span class="c1"># Calculate summary statistics</span>
            <span class="n">avg_files_per_folder</span> <span class="o">=</span> <span class="n">file_count</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">folder_count</span><span class="p">)</span>

            <span class="c1"># Find folders with most files</span>
            <span class="n">top_folders_by_file_count</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files_per_folder</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>

            <span class="c1"># Build result dictionary</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">path_root</span><span class="p">),</span>
                <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;total_files&quot;</span><span class="p">:</span> <span class="n">file_count</span><span class="p">,</span>
                    <span class="s2">&quot;total_folders&quot;</span><span class="p">:</span> <span class="n">folder_count</span><span class="p">,</span>
                    <span class="s2">&quot;total_size_bytes&quot;</span><span class="p">:</span> <span class="n">total_size</span><span class="p">,</span>
                    <span class="s2">&quot;total_size_mb&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="s2">&quot;avg_files_per_folder&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">avg_files_per_folder</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                    <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">depth_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">depth_stats</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;empty_folder_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">),</span>
                <span class="p">},</span>
                <span class="s2">&quot;file_extensions&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">file_extensions</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)),</span>
                <span class="s2">&quot;common_folder_names&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">folder_names</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)),</span>
                <span class="s2">&quot;empty_folders&quot;</span><span class="p">:</span> <span class="n">empty_folders</span><span class="p">,</span>
                <span class="s2">&quot;top_folders_by_file_count&quot;</span><span class="p">:</span> <span class="n">top_folders_by_file_count</span><span class="p">,</span>
                <span class="s2">&quot;depth_distribution&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">depth_stats</span><span class="p">),</span>
            <span class="p">}</span>

            <span class="c1"># Add DataFrame if enabled</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s2">&quot;dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">all_paths</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
                <span class="n">progress</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print a summary of the directory analysis (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_summary expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">summary</span>
        <span class="n">timing</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">timing</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="c1"># Show which implementation was used with more detail</span>
        <span class="n">impl_type</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;implementation&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>

        <span class="c1"># Add DataFrame indicator</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">analysis</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">impl_type</span> <span class="o">+=</span> <span class="s2">&quot; +  DataFrame&quot;</span>

        <span class="c1"># Main summary table</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Directory Analysis: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">impl_type</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">if</span> <span class="n">timing</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">timing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;elapsed_seconds&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Metric&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold cyan&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Total Files&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_files&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Total Folders&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_folders&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Total Size&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_size_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Average Files per Folder&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;avg_files_per_folder&quot;</span><span class="p">]))</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Maximum Depth&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;max_depth&quot;</span><span class="p">]))</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Empty Folders&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;empty_folder_count&quot;</span><span class="p">]))</span>

        <span class="c1"># Add DataFrame info if available</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">analysis</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">dataframe</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;DataFrame Rows&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Add timing information if available</span>
        <span class="k">if</span> <span class="n">timing</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Analysis Time&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timing</span><span class="p">[</span><span class="s1">&#39;elapsed_seconds&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">timing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;items_per_second&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Processing Speed&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timing</span><span class="p">[</span><span class="s1">&#39;items_per_second&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> items/sec&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;DataFrame&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the DataFrame from analysis results.</span>

<span class="sd">        Args:</span>
<span class="sd">        ----</span>
<span class="sd">            analysis: :class:`DirectoryAnalysis` instance</span>

<span class="sd">        Returns:</span>
<span class="sd">        -------</span>
<span class="sd">            DataFrame object if available, None otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;get_dataframe expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">analysis</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_dataframe_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if DataFrame building is enabled and available.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            True if DataFrame building is enabled, False otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">DATAFRAME_AVAILABLE</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detect_filesystem_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Attempt to detect the filesystem type for a given path.</span>

<span class="sd">        Returns the fs type string (e.g., &#39;nfs&#39;, &#39;ext4&#39;) or None if not detected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Parse /proc/mounts for the mount containing the path</span>
            <span class="n">mounts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/proc/mounts&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">mounts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># (mount_point, fs_type)</span>

            <span class="c1"># Find best match by longest mount_point prefix</span>
            <span class="n">best</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mnt</span><span class="p">,</span> <span class="n">fst</span> <span class="ow">in</span> <span class="n">mounts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">mnt</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">mnt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">best</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">best</span> <span class="o">=</span> <span class="p">(</span><span class="n">mnt</span><span class="p">,</span> <span class="n">fst</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">best</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">best</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Fallback: try os.statvfs and map f_fsid is not portable; return None</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_file_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">,</span> <span class="n">top_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the most common file extensions (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_file_extensions expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

        <span class="n">extensions</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">file_extensions</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">extensions</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;File Extensions&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Extension&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold magenta&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Percentage&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
        <span class="n">total_files</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;total_files&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">ext</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="n">top_n</span><span class="p">]:</span>
            <span class="n">percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="n">total_files</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_files</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_folder_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">,</span> <span class="n">top_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the most common folder names (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_folder_patterns expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

        <span class="n">folder_names</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">common_folder_names</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">folder_names</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Common Folder Names&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Folder Name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold blue&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Occurrences&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">folder_names</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="n">top_n</span><span class="p">]:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_empty_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">,</span> <span class="n">max_show</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print empty folders found (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_empty_folders expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

        <span class="n">empty_folders</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">empty_folders</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_folders</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;[green] No empty folders found![/green]&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Empty Folders (showing </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">),</span><span class="w"> </span><span class="n">max_show</span><span class="p">)</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">empty_folders</span><span class="p">[:</span><span class="n">max_show</span><span class="p">]:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_show</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">max_show</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print a comprehensive report of the directory analysis.</span>

<span class="sd">        Expects a :class:`DirectoryAnalysis` instance. Use :meth:`to_dict`</span>
<span class="sd">        if you need a plain dict shape for downstream tooling.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_report expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">print_summary</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_file_extensions</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_folder_patterns</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_empty_folders</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the directory profiler.</p>
<p>The profiler is configured with a <code>DirectoryProfilerConfig</code> instance which
holds options such as whether to use Rust acceleration, parallel processing,
fd integration, thresholding for parallelism, DataFrame building, and progress
reporting callbacks. Pass a <code>DirectoryProfilerConfig</code> object as the single
<code>config</code> argument. See <code>DirectoryProfilerConfig</code> for descriptions of each
configurable field.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="s2">&quot;DirectoryProfilerConfig&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the directory profiler.</span>

<span class="sd">    The profiler is configured with a `DirectoryProfilerConfig` instance which</span>
<span class="sd">    holds options such as whether to use Rust acceleration, parallel processing,</span>
<span class="sd">    fd integration, thresholding for parallelism, DataFrame building, and progress</span>
<span class="sd">    reporting callbacks. Pass a `DirectoryProfilerConfig` object as the single</span>
<span class="sd">    `config` argument. See `DirectoryProfilerConfig` for descriptions of each</span>
<span class="sd">    configurable field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Expect a DirectoryProfilerConfig object  no legacy kwargs supported.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;__class__&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">config</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;DirectoryProfilerConfig&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DirectoryProfiler requires a DirectoryProfilerConfig instance as the sole argument&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>

    <span class="c1"># Set simple aliases for common flags to preserve prior attribute names</span>
    <span class="c1"># Internal availability checks are still performed below.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">search_backend</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">parallel_threshold</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fast_path_only</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">fast_path_only</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">progress_callback</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">progress_callback</span>

    <span class="c1"># Validate availability and enforce clear relationships</span>
    <span class="c1"># Use explicit booleans from the config</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Rust implementation requested but not available in this build&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Parallel Rust requested but not available&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">RUST_ASYNC_AVAILABLE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Async Rust prober requested but not available in this build&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;fd integration requested but not available in this environment&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;DataFrame building requested but Polars/DataFrame support is not available&quot;</span><span class="p">)</span>

    <span class="c1"># Network args only apply when use_async is True (explicit)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">!=</span> <span class="mi">64</span><span class="p">,</span>
            <span class="n">config</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">!=</span> <span class="mi">5000</span><span class="p">,</span>
            <span class="n">config</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Network tuning parameters only apply when use_async=True&quot;</span><span class="p">)</span>

    <span class="c1"># Threads only applies when use_fd is True</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">threads</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;threads&#39; setting only applies when use_fd=True&quot;</span><span class="p">)</span>

    <span class="c1"># Decide which implementation to use based on search_backend and availability</span>
    <span class="n">backend_choice</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">search_backend</span>
    <span class="k">if</span> <span class="n">backend_choice</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
        <span class="c1"># Honor explicit user preferences when provided.</span>
        <span class="c1"># If both backends are explicitly requested and available, prefer fd</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span> <span class="ow">and</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
            <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;fd&quot;</span>
        <span class="c1"># If user explicitly requested Rust and it&#39;s available, use it</span>
        <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
            <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;rust&quot;</span>
        <span class="c1"># If user explicitly requested fd and it&#39;s available, use it</span>
        <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
            <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;fd&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No explicit preference from user -&gt; auto-detect best available</span>
            <span class="k">if</span> <span class="n">RUST_AVAILABLE</span><span class="p">:</span>
                <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;rust&quot;</span>
            <span class="k">elif</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
                <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;fd&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">backend_choice</span> <span class="o">=</span> <span class="s2">&quot;python&quot;</span>

    <span class="k">if</span> <span class="n">backend_choice</span> <span class="o">==</span> <span class="s2">&quot;rust&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="n">backend_choice</span> <span class="o">==</span> <span class="s2">&quot;fd&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Parallel/async/other toggles come directly from config (already validated)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_async</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span><span class="p">)</span>

    <span class="c1"># Other instance-level flags</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">build_dataframe</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">)</span>
    <span class="c1"># Progress handling</span>
    <span class="k">if</span> <span class="n">_is_interactive_environment</span><span class="p">()</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Interactive environment detected, disabling progress bars to avoid conflicts&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">show_progress</span><span class="p">)</span>

    <span class="c1"># Network tuning (only valid if use_async True)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">network_concurrency</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">network_timeout_ms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">network_retries</span>

    <span class="c1"># Threads forwarded to fd if using fd backend</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">threads</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">threads</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="c1"># Defer fd integration initialization until actually used</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fd_integration</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.get_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_dataframe</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_dataframe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the DataFrame from analysis results.</p>
        <hr />
<pre><code>analysis: :class:`DirectoryAnalysis` instance
</code></pre>
        <hr />
<pre><code>DataFrame object if available, None otherwise
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;DataFrame&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the DataFrame from analysis results.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        analysis: :class:`DirectoryAnalysis` instance</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">        DataFrame object if available, None otherwise</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;get_dataframe expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">analysis</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_implementation_info</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get information about which implementations are available and being used.</p>
<h5 id="filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info--returns">Returns<a class="headerlink" href="#filoma.directories.directory_profiler.DirectoryProfiler.get_implementation_info--returns" title="Permanent link">&para;</a></h5>
<pre><code>Dictionary with implementation availability status
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_implementation_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get information about which implementations are available and being used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Dictionary with implementation availability status</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;rust_available&quot;</span><span class="p">:</span> <span class="n">RUST_AVAILABLE</span><span class="p">,</span>
        <span class="s2">&quot;rust_parallel_available&quot;</span><span class="p">:</span> <span class="n">RUST_PARALLEL_AVAILABLE</span><span class="p">,</span>
        <span class="s2">&quot;rust_async_available&quot;</span><span class="p">:</span> <span class="n">RUST_ASYNC_AVAILABLE</span><span class="p">,</span>
        <span class="s2">&quot;fd_available&quot;</span><span class="p">:</span> <span class="n">FD_AVAILABLE</span><span class="p">,</span>
        <span class="s2">&quot;dataframe_available&quot;</span><span class="p">:</span> <span class="n">DATAFRAME_AVAILABLE</span><span class="p">,</span>
        <span class="s2">&quot;using_rust&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span><span class="p">,</span>
        <span class="s2">&quot;using_parallel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span><span class="p">,</span>
        <span class="s2">&quot;using_async&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="n">RUST_ASYNC_AVAILABLE</span><span class="p">),</span>
        <span class="s2">&quot;using_fd&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span><span class="p">,</span>
        <span class="s2">&quot;using_dataframe&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span><span class="p">,</span>
        <span class="s2">&quot;return_absolute_paths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
        <span class="s2">&quot;search_backend&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span><span class="p">,</span>
        <span class="s2">&quot;python_fallback&quot;</span><span class="p">:</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span><span class="p">),</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dataframe_enabled</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if DataFrame building is enabled and available.</p>
<h5 id="filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled--returns">Returns<a class="headerlink" href="#filoma.directories.directory_profiler.DirectoryProfiler.is_dataframe_enabled--returns" title="Permanent link">&para;</a></h5>
<pre><code>True if DataFrame building is enabled, False otherwise
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_dataframe_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if DataFrame building is enabled and available.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        True if DataFrame building is enabled, False otherwise</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">DATAFRAME_AVAILABLE</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_fd_available</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if fd integration is available and being used.</p>
<h5 id="filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available--returns">Returns<a class="headerlink" href="#filoma.directories.directory_profiler.DirectoryProfiler.is_fd_available--returns" title="Permanent link">&para;</a></h5>
<pre><code>True if fd is available and enabled, False otherwise
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_fd_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if fd integration is available and being used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        True if fd is available and enabled, False otherwise</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use FD_AVAILABLE to reflect whether the fd integration package is importable</span>
    <span class="c1"># Tests may monkeypatch FD_AVAILABLE without having the fd binary present.</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span> <span class="ow">and</span> <span class="n">FD_AVAILABLE</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_parallel_available</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if parallel Rust implementation is available and being used.</p>
<h5 id="filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available--returns">Returns<a class="headerlink" href="#filoma.directories.directory_profiler.DirectoryProfiler.is_parallel_available--returns" title="Permanent link">&para;</a></h5>
<pre><code>True if parallel Rust implementation is available and enabled, False otherwise
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_parallel_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if parallel Rust implementation is available and being used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        True if parallel Rust implementation is available and enabled, False otherwise</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_parallel</span> <span class="ow">and</span> <span class="n">RUST_PARALLEL_AVAILABLE</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_rust_available</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if Rust implementation is available and being used.</p>
<h5 id="filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available--returns">Returns<a class="headerlink" href="#filoma.directories.directory_profiler.DirectoryProfiler.is_rust_available--returns" title="Permanent link">&para;</a></h5>
<pre><code>True if Rust implementation is available and enabled, False otherwise
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_rust_available</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if Rust implementation is available and being used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        True if Rust implementation is available and enabled, False otherwise</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_rust</span> <span class="ow">and</span> <span class="n">RUST_AVAILABLE</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.print_empty_folders" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_empty_folders</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">max_show</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_empty_folders" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print empty folders found (expects DirectoryAnalysis).</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_empty_folders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">,</span> <span class="n">max_show</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print empty folders found (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_empty_folders expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

    <span class="n">empty_folders</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">empty_folders</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">empty_folders</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;[green] No empty folders found![/green]&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Empty Folders (showing </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">),</span><span class="w"> </span><span class="n">max_show</span><span class="p">)</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">empty_folders</span><span class="p">[:</span><span class="n">max_show</span><span class="p">]:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_show</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_folders</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">max_show</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.print_file_extensions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_file_extensions</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_file_extensions" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print the most common file extensions (expects DirectoryAnalysis).</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_file_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">,</span> <span class="n">top_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the most common file extensions (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_file_extensions expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

    <span class="n">extensions</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">file_extensions</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">extensions</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;File Extensions&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Extension&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold magenta&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Percentage&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">total_files</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;total_files&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">ext</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="n">top_n</span><span class="p">]:</span>
        <span class="n">percentage</span> <span class="o">=</span> <span class="p">(</span><span class="n">count</span> <span class="o">/</span> <span class="n">total_files</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_files</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.print_folder_patterns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_folder_patterns</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_folder_patterns" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print the most common folder names (expects DirectoryAnalysis).</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_folder_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">,</span> <span class="n">top_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the most common folder names (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_folder_patterns expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

    <span class="n">folder_names</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">common_folder_names</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">folder_names</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Common Folder Names&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Folder Name&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold blue&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Occurrences&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">folder_names</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="n">top_n</span><span class="p">]:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.print_report" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_report</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_report" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print a comprehensive report of the directory analysis.</p>
<p>Expects a :class:<code>DirectoryAnalysis</code> instance. Use :meth:<code>to_dict</code>
if you need a plain dict shape for downstream tooling.</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print a comprehensive report of the directory analysis.</span>

<span class="sd">    Expects a :class:`DirectoryAnalysis` instance. Use :meth:`to_dict`</span>
<span class="sd">    if you need a plain dict shape for downstream tooling.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_report expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">print_summary</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">print_file_extensions</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">print_folder_patterns</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">print_empty_folders</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.print_summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_summary</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.print_summary" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print a summary of the directory analysis (expects DirectoryAnalysis).</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print a summary of the directory analysis (expects DirectoryAnalysis).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">analysis</span><span class="p">,</span> <span class="n">DirectoryAnalysis</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;print_summary expects a DirectoryAnalysis instance&quot;</span><span class="p">)</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">summary</span>
    <span class="n">timing</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">timing</span> <span class="ow">or</span> <span class="p">{}</span>

    <span class="c1"># Show which implementation was used with more detail</span>
    <span class="n">impl_type</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;implementation&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>

    <span class="c1"># Add DataFrame indicator</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">analysis</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">impl_type</span> <span class="o">+=</span> <span class="s2">&quot; +  DataFrame&quot;</span>

    <span class="c1"># Main summary table</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Directory Analysis: </span><span class="si">{</span><span class="n">analysis</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">impl_type</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">if</span> <span class="n">timing</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">timing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;elapsed_seconds&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Metric&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold cyan&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Total Files&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_files&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Total Folders&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_folders&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Total Size&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_size_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Average Files per Folder&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;avg_files_per_folder&quot;</span><span class="p">]))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Maximum Depth&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;max_depth&quot;</span><span class="p">]))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Empty Folders&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">summary</span><span class="p">[</span><span class="s2">&quot;empty_folder_count&quot;</span><span class="p">]))</span>

    <span class="c1"># Add DataFrame info if available</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_dataframe</span> <span class="ow">and</span> <span class="n">analysis</span><span class="o">.</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">dataframe</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;DataFrame Rows&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Add timing information if available</span>
    <span class="k">if</span> <span class="n">timing</span><span class="p">:</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Analysis Time&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timing</span><span class="p">[</span><span class="s1">&#39;elapsed_seconds&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">timing</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;items_per_second&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="s2">&quot;Processing Speed&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timing</span><span class="p">[</span><span class="s1">&#39;items_per_second&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> items/sec&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.probe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">probe</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.probe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Analyze a directory tree and return comprehensive statistics.</p>
        <hr />
<pre><code>path: Path to the root directory to probe
max_depth: Maximum depth to traverse (None for unlimited)
threads: Optional override for number of threads when using fd backend
</code></pre>
        <hr />
<pre><code>A :class:`DirectoryAnalysis` instance containing analysis results
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">probe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">threads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DirectoryAnalysis&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze a directory tree and return comprehensive statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        path: Path to the root directory to probe</span>
<span class="sd">        max_depth: Maximum depth to traverse (None for unlimited)</span>
<span class="sd">        threads: Optional override for number of threads when using fd backend</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">        A :class:`DirectoryAnalysis` instance containing analysis results</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Choose the best backend</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_choose_backend</span><span class="p">()</span>

    <span class="c1"># Log the start of analysis</span>
    <span class="n">impl_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_impl_display_name</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting directory analysis of &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; using </span><span class="si">{</span><span class="n">impl_type</span><span class="si">}</span><span class="s2"> implementation&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;fd&quot;</span><span class="p">:</span>
            <span class="c1"># threads param overrides instance threads when provided</span>
            <span class="n">chosen_threads</span> <span class="o">=</span> <span class="n">threads</span> <span class="k">if</span> <span class="n">threads</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">threads</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_fd</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">chosen_threads</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;rust&quot;</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_rust</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">fast_path_only</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fast_path_only</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probe_python</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>

        <span class="c1"># Calculate and log timing</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">total_items</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">][</span><span class="s2">&quot;total_files&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">][</span><span class="s2">&quot;total_folders&quot;</span><span class="p">]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Directory analysis completed in </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s - &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="n">total_items</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> items (</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_files&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> files, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_folders&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> folders) using </span><span class="si">{</span><span class="n">impl_type</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Add timing information to result</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;timing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;elapsed_seconds&quot;</span><span class="p">:</span> <span class="n">elapsed_time</span><span class="p">,</span>
            <span class="s2">&quot;implementation&quot;</span><span class="p">:</span> <span class="n">impl_type</span><span class="p">,</span>
            <span class="s2">&quot;items_per_second&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">total_items</span> <span class="o">/</span> <span class="n">elapsed_time</span> <span class="k">if</span> <span class="n">elapsed_time</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="c1"># Return a structured dataclass by default for easier programmatic use</span>
        <span class="k">return</span> <span class="n">DirectoryAnalysis</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Directory analysis failed after </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfiler.sample_paths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_paths</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfiler.sample_paths" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return small samples of paths for quick backend-diffing.</p>
<p>Returns a dict with keys 'fd_files', 'fd_dirs', 'python_files'. Rust currently
does not expose a path list in the public API so it is omitted (you can
re-run the Rust prober separately if needed).</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return small samples of paths for quick backend-diffing.</span>

<span class="sd">    Returns a dict with keys &#39;fd_files&#39;, &#39;fd_dirs&#39;, &#39;python_files&#39;. Rust currently</span>
<span class="sd">    does not expose a path list in the public API so it is omitted (you can</span>
<span class="sd">    re-run the Rust prober separately if needed).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fd_files&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;fd_dirs&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;python_files&quot;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">FD_AVAILABLE</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="n">FdIntegration</span><span class="p">()</span>
            <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span>
                <span class="n">max_results</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
                <span class="n">search_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">no_ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">follow_links</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">absolute_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_dirs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                <span class="n">file_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">],</span>
                <span class="n">max_results</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
                <span class="n">search_hidden</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">no_ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">follow_links</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">absolute_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_absolute_paths</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;fd_dirs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Python sample</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">python_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="n">python_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">python_files</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">sample_size</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;python_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">python_files</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">samples</span><span class="p">[</span><span class="s2">&quot;python_files&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">return</span> <span class="n">samples</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="filoma.directories.directory_profiler.DirectoryProfilerConfig" class="doc doc-heading">
            <code>DirectoryProfilerConfig</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#filoma.directories.directory_profiler.DirectoryProfilerConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Configuration for DirectoryProfiler (explicit, typed, no legacy kwargs).</p>
<p>All fields are documented and validated in <strong>post_init</strong>.</p>








              <details class="quote">
                <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DirectoryProfilerConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for DirectoryProfiler (explicit, typed, no legacy kwargs).</span>

<span class="sd">    All fields are documented and validated in __post_init__.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Backend selection</span>
    <span class="n">use_rust</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">use_parallel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">use_async</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">use_fd</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">search_backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>  <span class="c1"># &#39;rust&#39; | &#39;fd&#39; | &#39;python&#39; | &#39;auto&#39;</span>

    <span class="c1"># General tuning</span>
    <span class="n">parallel_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">build_dataframe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">return_absolute_paths</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">progress_callback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">fast_path_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Network tuning (only valid when use_async is True)</span>
    <span class="n">network_concurrency</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">network_timeout_ms</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5000</span>
    <span class="n">network_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># fd-specific tuning</span>
    <span class="n">threads</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate configuration fields after initialization.</span>

<span class="sd">        Ensures values are within acceptable ranges and relationships are</span>
<span class="sd">        enforced (for example, network tuning only when async is enabled).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Basic validations</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;rust&quot;</span><span class="p">,</span> <span class="s2">&quot;fd&quot;</span><span class="p">,</span> <span class="s2">&quot;python&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;search_backend must be one of &#39;auto&#39;,&#39;rust&#39;,&#39;fd&#39;,&#39;python&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;parallel_threshold must be a non-negative integer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;network_concurrency must be a positive integer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;network_timeout_ms must be positive&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;network_retries must be non-negative&quot;</span><span class="p">)</span>

        <span class="c1"># Relationship validations</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">!=</span> <span class="mi">64</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">!=</span> <span class="mi">5000</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Network tuning parameters only apply when use_async=True&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threads</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;threads&#39; only applies when use_fd=True&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="filoma.directories.directory_profiler.DirectoryProfilerConfig.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#filoma.directories.directory_profiler.DirectoryProfilerConfig.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Validate configuration fields after initialization.</p>
<p>Ensures values are within acceptable ranges and relationships are
enforced (for example, network tuning only when async is enabled).</p>


            <details class="quote">
              <summary>Source code in <code>src/filoma/directories/directory_profiler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate configuration fields after initialization.</span>

<span class="sd">    Ensures values are within acceptable ranges and relationships are</span>
<span class="sd">    enforced (for example, network tuning only when async is enabled).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Basic validations</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;rust&quot;</span><span class="p">,</span> <span class="s2">&quot;fd&quot;</span><span class="p">,</span> <span class="s2">&quot;python&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;search_backend must be one of &#39;auto&#39;,&#39;rust&#39;,&#39;fd&#39;,&#39;python&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_threshold</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;parallel_threshold must be a non-negative integer&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;network_concurrency must be a positive integer&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;network_timeout_ms must be positive&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;network_retries must be non-negative&quot;</span><span class="p">)</span>

    <span class="c1"># Relationship validations</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_async</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_concurrency</span> <span class="o">!=</span> <span class="mi">64</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout_ms</span> <span class="o">!=</span> <span class="mi">5000</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_retries</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Network tuning parameters only apply when use_async=True&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threads</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fd</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;threads&#39; only applies when use_fd=True&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>